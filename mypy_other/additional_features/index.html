
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="hellowac-类型检查">
      
      
      
      
        <link rel="prev" href="../error_code_list2/">
      
      
        <link rel="next" href="../faq/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>额外特性 - mypy静态类型检查器</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#附加功能" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="mypy静态类型检查器" class="md-header__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mypy静态类型检查器
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              额外特性
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  欢迎来到mypy文档!

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy/" class="md-tabs__link">
          
  
    
  
  第一步

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy/builtin_types/" class="md-tabs__link">
          
  
    
  
  类型系统参考

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy_conf/" class="md-tabs__link">
          
  
    
  
  配置和运行mypy

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  其他杂项

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../project_links/" class="md-tabs__link">
        
  
    
  
  项目链接

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mypy静态类型检查器" class="md-nav__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    mypy静态类型检查器
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欢迎来到mypy文档!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    第一步
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            第一步
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/cheat_sheet_py3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型提示备忘录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/existing_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将 mypy 与现有代码库结合使用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    类型系统参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            类型系统参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/builtin_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内置类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/type_inference_type_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型推断和类型注解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/kind_of_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型种类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/class_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类的基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/annotation_issue_at_runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行时的注解问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/protocol_and_struct_subtyping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    协议及其子类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/dynamic_typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    动态类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/type_narrowing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型收缩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/duck_type_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    鸭子类型兼容
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/stub_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    存根文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/generics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泛型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/more_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    更多类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/literal_and_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    字面量和枚举
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/typeddict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型字典
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/final_names_methods_classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最终名称、方法和类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/metaclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    元类
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy_conf/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    配置和运行mypy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            配置和运行mypy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/running_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行mypy和管理导入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/command_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy命令行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/config_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy配置文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/inline_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内联配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/mypy_daemon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy服务(守护进程)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/installed_packages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用安装包
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/extending_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    扩展和集成 mypy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/stubgen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/stubtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根测试
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    其他杂项
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            其他杂项
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../common_issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题及解决办法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../supported_python_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    支持的 Python 特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../error_codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../error_code_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    默认启用的错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../error_code_list2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    可选检查的错误代码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    额外特性
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    额外特性
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#数据类" class="md-nav__link">
    数据类
  </a>
  
    <nav class="md-nav" aria-label="数据类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#注意事项已知问题" class="md-nav__link">
    注意事项/已知问题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#数据类转换" class="md-nav__link">
    数据类转换
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attrs-包" class="md-nav__link">
    attrs 包
  </a>
  
    <nav class="md-nav" aria-label="attrs 包">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#注意事项已知问题2" class="md-nav__link">
    注意事项/已知问题2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#使用远程缓存加速-mypy-运行" class="md-nav__link">
    使用远程缓存加速 mypy 运行
  </a>
  
    <nav class="md-nav" aria-label="使用远程缓存加速 mypy 运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#缓存文件的共享仓库" class="md-nav__link">
    缓存文件的共享仓库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#持续集成构建" class="md-nav__link">
    持续集成构建
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mypy-包装脚本" class="md-nav__link">
    Mypy 包装脚本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#使用-mypy-守护进程进行缓存" class="md-nav__link">
    使用 mypy 守护进程进行缓存
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#改进" class="md-nav__link">
    改进
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#扩展的-callable-类型" class="md-nav__link">
    扩展的 Callable 类型
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题解答
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../project_links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    项目链接
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#数据类" class="md-nav__link">
    数据类
  </a>
  
    <nav class="md-nav" aria-label="数据类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#注意事项已知问题" class="md-nav__link">
    注意事项/已知问题
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#数据类转换" class="md-nav__link">
    数据类转换
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attrs-包" class="md-nav__link">
    attrs 包
  </a>
  
    <nav class="md-nav" aria-label="attrs 包">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#注意事项已知问题2" class="md-nav__link">
    注意事项/已知问题2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#使用远程缓存加速-mypy-运行" class="md-nav__link">
    使用远程缓存加速 mypy 运行
  </a>
  
    <nav class="md-nav" aria-label="使用远程缓存加速 mypy 运行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#缓存文件的共享仓库" class="md-nav__link">
    缓存文件的共享仓库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#持续集成构建" class="md-nav__link">
    持续集成构建
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mypy-包装脚本" class="md-nav__link">
    Mypy 包装脚本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#使用-mypy-守护进程进行缓存" class="md-nav__link">
    使用 mypy 守护进程进行缓存
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#改进" class="md-nav__link">
    改进
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#扩展的-callable-类型" class="md-nav__link">
    扩展的 Callable 类型
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="附加功能">附加功能<a class="headerlink" href="#附加功能" title="Permanent link">&para;</a></h1>
<p><strong>Additional features</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>这一部分讨论了在之前的部分中没有自然融入的各种特性。</p>
</div>
<div class="tabbed-block">
<p>This section discusses various features that did not fit in naturally in one of the previous sections.</p>
</div>
</div>
</div>
<h2 id="数据类">数据类<a class="headerlink" href="#数据类" title="Permanent link">&para;</a></h2>
<p><strong>Dataclasses</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses">dataclasses</a> 模块允许定义和自定义简单的无样板类。可以使用 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">@dataclasses.dataclass</a> 装饰器来定义这些类：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass, field

<span style="color: #AA22FF">@dataclass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Application</span>:
    name: <span style="color: #008000">str</span>
    plugins: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> field(default_factory<span style="color: #666666">=</span><span style="color: #008000">list</span>)

test <span style="color: #666666">=</span> Application(<span style="color: #BA2121">&quot;Testing...&quot;</span>)  <span style="color: #3D7B7B; font-style: italic"># 正常</span>
bad <span style="color: #666666">=</span> Application(<span style="color: #BA2121">&quot;Testing...&quot;</span>, <span style="color: #BA2121">&quot;with plugin&quot;</span>)  <span style="color: #3D7B7B; font-style: italic"># 错误：期望 list[str]</span>
</code></pre></div>
<p>Mypy 将根据定义 dataclasses 时使用的标志来检测特殊方法（如 <a href="https://docs.python.org/3/reference/datamodel.html#object.__lt__">__lt__</a>）。例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass

<span style="color: #AA22FF">@dataclass</span>(order<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">OrderedPoint</span>:
    x: <span style="color: #008000">int</span>
    y: <span style="color: #008000">int</span>

<span style="color: #AA22FF">@dataclass</span>(order<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">UnorderedPoint</span>:
    x: <span style="color: #008000">int</span>
    y: <span style="color: #008000">int</span>

OrderedPoint(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>) <span style="color: #666666">&lt;</span> OrderedPoint(<span style="color: #666666">3</span>, <span style="color: #666666">4</span>)  <span style="color: #3D7B7B; font-style: italic"># 正常</span>
UnorderedPoint(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>) <span style="color: #666666">&lt;</span> UnorderedPoint(<span style="color: #666666">3</span>, <span style="color: #666666">4</span>)  <span style="color: #3D7B7B; font-style: italic"># 错误：不支持的操作数类型</span>
</code></pre></div>
<p>数据类可以是泛型的，并且可以像普通类一样使用：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Generic, TypeVar

T <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;T&#39;</span>)

<span style="color: #AA22FF">@dataclass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">BoxedData</span>(Generic[T]):
    data: T
    label: <span style="color: #008000">str</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">unbox</span>(bd: BoxedData[T]) <span style="color: #666666">-&gt;</span> T:
    <span style="color: #666666">...</span>

val <span style="color: #666666">=</span> unbox(BoxedData(<span style="color: #666666">42</span>, <span style="color: #BA2121">&quot;&lt;important&gt;&quot;</span>))  <span style="color: #3D7B7B; font-style: italic"># 正常，推断类型为 int</span>
</code></pre></div>
<p>有关更多信息，请参见 <a href="https://docs.python.org/3/library/dataclasses.html">官方文档</a> 和 <a href="https://peps.python.org/pep-0557/">PEP 557</a>。</p>
</div>
<div class="tabbed-block">
<p>The <a href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses">dataclasses</a> module allows defining and customizing simple boilerplate-free classes. They can be defined using the <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">@dataclasses.dataclass</a> decorator:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass, field

<span style="color: #AA22FF">@dataclass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Application</span>:
    name: <span style="color: #008000">str</span>
    plugins: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> field(default_factory<span style="color: #666666">=</span><span style="color: #008000">list</span>)

test <span style="color: #666666">=</span> Application(<span style="color: #BA2121">&quot;Testing...&quot;</span>)  <span style="color: #3D7B7B; font-style: italic"># OK</span>
bad <span style="color: #666666">=</span> Application(<span style="color: #BA2121">&quot;Testing...&quot;</span>, <span style="color: #BA2121">&quot;with plugin&quot;</span>)  <span style="color: #3D7B7B; font-style: italic"># Error: list[str] expected</span>
</code></pre></div>
<p>Mypy will detect special methods (such as <a href="https://docs.python.org/3/reference/datamodel.html#object.__lt__">__lt__</a>) depending on the flags used to define dataclasses. For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass

<span style="color: #AA22FF">@dataclass</span>(order<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">OrderedPoint</span>:
    x: <span style="color: #008000">int</span>
    y: <span style="color: #008000">int</span>

<span style="color: #AA22FF">@dataclass</span>(order<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">UnorderedPoint</span>:
    x: <span style="color: #008000">int</span>
    y: <span style="color: #008000">int</span>

OrderedPoint(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>) <span style="color: #666666">&lt;</span> OrderedPoint(<span style="color: #666666">3</span>, <span style="color: #666666">4</span>)  <span style="color: #3D7B7B; font-style: italic"># OK</span>
UnorderedPoint(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>) <span style="color: #666666">&lt;</span> UnorderedPoint(<span style="color: #666666">3</span>, <span style="color: #666666">4</span>)  <span style="color: #3D7B7B; font-style: italic"># Error: Unsupported operand types</span>
</code></pre></div>
<p>Dataclasses can be generic and can be used in any other way a normal class can be used:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Generic, TypeVar

T <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;T&#39;</span>)

<span style="color: #AA22FF">@dataclass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">BoxedData</span>(Generic[T]):
    data: T
    label: <span style="color: #008000">str</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">unbox</span>(bd: BoxedData[T]) <span style="color: #666666">-&gt;</span> T:
    <span style="color: #666666">...</span>

val <span style="color: #666666">=</span> unbox(BoxedData(<span style="color: #666666">42</span>, <span style="color: #BA2121">&quot;&lt;important&gt;&quot;</span>))  <span style="color: #3D7B7B; font-style: italic"># OK, inferred type is int</span>
</code></pre></div>
<p>For more information see <a href="https://docs.python.org/3/library/dataclasses.html">official docs</a> and <a href="https://peps.python.org/pep-0557/">PEP 557</a>.</p>
</div>
</div>
</div>
<h3 id="注意事项已知问题">注意事项/已知问题<a class="headerlink" href="#注意事项已知问题" title="Permanent link">&para;</a></h3>
<p><strong>Caveats/Known Issues</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在 <a href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses">dataclasses</a> 模块中，一些函数，如 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.asdict">asdict()</a>，具有不精确（过于宽松）的类型。这将在未来的版本中修复。</p>
<p>Mypy 目前尚不识别 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">dataclasses.dataclass</a> 的别名，并且可能永远不会识别动态计算的装饰器。以下示例 <strong>不</strong> 能正常工作：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass

dataclass_alias <span style="color: #666666">=</span> dataclass
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dataclass_wrapper</span>(<span style="color: #008000">cls</span>):
    <span style="color: #008000; font-weight: bold">return</span> dataclass(<span style="color: #008000">cls</span>)

<span style="color: #AA22FF">@dataclass_alias</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AliasDecorated</span>:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Mypy 不识别此类为数据类，因为它是由 `dataclass` 的别名装饰的，而不是由 `dataclass` 本身装饰的。</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    attribute: <span style="color: #008000">int</span>

AliasDecorated(attribute<span style="color: #666666">=1</span>) <span style="color: #3D7B7B; font-style: italic"># 错误：意外的关键字参数</span>
</code></pre></div>
<p>要使 Mypy 识别 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">dataclasses.dataclass</a> 的包装器作为数据类装饰器，可以考虑使用 <a href="https://docs.python.org/3/library/typing.html#typing.dataclass_transform">dataclass_transform()</a> 装饰器：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass, Field
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> TypeVar, dataclass_transform

T <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;T&#39;</span>)

<span style="color: #AA22FF">@dataclass_transform</span>(field_specifiers<span style="color: #666666">=</span>(Field,))
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">my_dataclass</span>(<span style="color: #008000">cls</span>: <span style="color: #008000">type</span>[T]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">type</span>[T]:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> dataclass(<span style="color: #008000">cls</span>)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Some functions in the <a href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses">dataclasses</a> module, such as <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.asdict">asdict()</a>, have imprecise (too permissive) types. This will be fixed in future releases.</p>
<p>Mypy does not yet recognize aliases of <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">dataclasses.dataclass</a>, and will probably never recognize dynamically computed decorators. The following example does <strong>not</strong> work:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass

dataclass_alias <span style="color: #666666">=</span> dataclass
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dataclass_wrapper</span>(<span style="color: #008000">cls</span>):
<span style="color: #008000; font-weight: bold">return</span> dataclass(<span style="color: #008000">cls</span>)

<span style="color: #AA22FF">@dataclass_alias</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AliasDecorated</span>:
<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">Mypy doesn&#39;t recognize this as a dataclass because it is decorated by an</span>
<span style="color: #BA2121; font-style: italic">alias of `dataclass` rather than by `dataclass` itself.</span>
<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
attribute: <span style="color: #008000">int</span>

AliasDecorated(attribute<span style="color: #666666">=1</span>) <span style="color: #3D7B7B; font-style: italic"># error: Unexpected keyword argument</span>
</code></pre></div>
<p>To have Mypy recognize a wrapper of <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass">dataclasses.dataclass</a> as a dataclass decorator, consider using the <a href="https://docs.python.org/3/library/typing.html#typing.dataclass_transform">dataclass_transform()</a> decorator:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">dataclasses</span> <span style="color: #008000; font-weight: bold">import</span> dataclass, Field
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> TypeVar, dataclass_transform

T <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;T&#39;</span>)

<span style="color: #AA22FF">@dataclass_transform</span>(field_specifiers<span style="color: #666666">=</span>(Field,))
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">my_dataclass</span>(<span style="color: #008000">cls</span>: <span style="color: #008000">type</span>[T]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">type</span>[T]:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> dataclass(<span style="color: #008000">cls</span>)
</code></pre></div>
</div>
</div>
</div>
<h2 id="数据类转换">数据类转换<a class="headerlink" href="#数据类转换" title="Permanent link">&para;</a></h2>
<p><strong>Data Class Transforms</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Mypy 支持 <a href="https://docs.python.org/3/library/typing.html#typing.dataclass_transform">dataclass_transform()</a> 装饰器，如 <a href="https://www.python.org/dev/peps/pep-0681/#the-dataclass-transform-decorator">PEP 681</a> 中所述。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>实际上，Mypy 将假定这样的类具有内部属性 <code>__dataclass_fields__</code>（即使它们在运行时可能没有该属性），并将假定函数如 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.is_dataclass">dataclasses.is_dataclass()</a> 和 <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.fields">dataclasses.fields()</a> 会将它们视为数据类（尽管它们在运行时可能会失败）。</p>
</div>
</div>
<div class="tabbed-block">
<p>Mypy supports the <a href="https://docs.python.org/3/library/typing.html#typing.dataclass_transform">dataclass_transform()</a> decorator as described in <a href="https://www.python.org/dev/peps/pep-0681/#the-dataclass-transform-decorator">PEP 681</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pragmatically, mypy will assume such classes have the internal attribute <code>__dataclass_fields__</code> (even though they might lack it in runtime) and will assume functions such as <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.is_dataclass">dataclasses.is_dataclass()</a> and <a href="https://docs.python.org/3/library/dataclasses.html#dataclasses.fields">dataclasses.fields()</a> treat them as if they were dataclasses (even though they may fail at runtime).</p>
</div>
</div>
</div>
</div>
<h2 id="attrs-包">attrs 包<a class="headerlink" href="#attrs-包" title="Permanent link">&para;</a></h2>
<p><strong>The attrs package</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a href="https://www.attrs.org/en/stable/index.html">attrs</a> 是一个可以让你定义类而无需编写样板代码的包。Mypy 可以检测到该包的使用，并将根据它找到的类型注解生成装饰类所需的方法定义。类型注解可以如下添加：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attr</span>

<span style="color: #AA22FF">@attr</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span>
    two: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">7</span>
    three: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field(<span style="color: #666666">8</span>)
</code></pre></div>
<p>如果你使用 <code>auto_attribs=False</code>，则必须使用 <code>attr.field</code>：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attr</span>

<span style="color: #AA22FF">@attr</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field()          <span style="color: #3D7B7B; font-style: italic"># 变量注解（Python 3.6+）</span>
    two <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field()  <span style="color: #3D7B7B; font-style: italic"># type: int  # 类型注释</span>
    three <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field(<span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">int</span>)     <span style="color: #3D7B7B; font-style: italic"># type= 参数</span>
</code></pre></div>
<p>Typeshed 有几个“善意谎言”注解，以便更容易进行类型检查。[attrs.field] 和 <a href="https://www.attrs.org/en/stable/api.html#attrs.Factory">attrs.Factory</a> 实际上返回对象，但注解说明这些返回期望被赋值的类型。这使得如下代码可以正常工作：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attr</span>

<span style="color: #AA22FF">@attr</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field(<span style="color: #666666">8</span>)
    two: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>] <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>Factory(<span style="color: #008000">dict</span>)
    bad: <span style="color: #008000">str</span> <span style="color: #666666">=</span> attr<span style="color: #666666">.</span>field(<span style="color: #666666">16</span>)   <span style="color: #3D7B7B; font-style: italic"># 错误：无法将 int 赋值给 str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><a href="https://www.attrs.org/en/stable/index.html">attrs</a> is a package that lets you define classes without writing boilerplate code. Mypy can detect uses of the package and will generate the necessary method definitions for decorated classes using the type annotations it finds. Type annotations can be added as follows:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attr</span>

<span style="color: #AA22FF">@attrs</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span>
    two: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">7</span>
    three: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field(<span style="color: #666666">8</span>)
</code></pre></div>
<p>If you're using <code>auto_attribs=False</code> you must use <code>attrs.field</code>:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attrs</span>

<span style="color: #AA22FF">@attrs</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field()          <span style="color: #3D7B7B; font-style: italic"># Variable annotation (Python 3.6+)</span>
    two <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field()  <span style="color: #3D7B7B; font-style: italic"># type: int  # Type comment</span>
    three <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field(<span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">int</span>)     <span style="color: #3D7B7B; font-style: italic"># type= argument</span>
</code></pre></div>
<p>Typeshed has a couple of "white lie" annotations to make type checking easier. [attrs.field] and <a href="https://www.attrs.org/en/stable/api.html#attrs.Factory">attrs.Factory</a> actually return objects, but the annotation says these return the types that they expect to be assigned to. That enables this to work:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attrs</span>

<span style="color: #AA22FF">@attrs</span><span style="color: #666666">.</span>define
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    one: <span style="color: #008000">int</span> <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field(<span style="color: #666666">8</span>)
    two: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, <span style="color: #008000">str</span>] <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>Factory(<span style="color: #008000">dict</span>)
    bad: <span style="color: #008000">str</span> <span style="color: #666666">=</span> attrs<span style="color: #666666">.</span>field(<span style="color: #666666">16</span>)   <span style="color: #3D7B7B; font-style: italic"># Error: can&#39;t assign int to str</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="注意事项已知问题2">注意事项/已知问题2<a class="headerlink" href="#注意事项已知问题2" title="Permanent link">&para;</a></h3>
<p><strong>Caveats/Known Issues2</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>
<p>对 <code>attr</code> 类和属性的检测仅通过函数名进行。这意味着如果你有自己的辅助函数，例如 <code>return attrs.field()</code>，mypy 将无法识别它们。</p>
</li>
<li>
<p>所有 mypy 关注的布尔参数必须是字面量 <code>True</code> 或 <code>False</code>。例如，下面的代码将不起作用：</p>
</li>
</ul>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attr</span>
YES <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #AA22FF">@attr</span><span style="color: #666666">.</span>define(init<span style="color: #666666">=</span>YES)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #666666">...</span>
</code></pre></div>
<ul>
<li>
<p>目前，<code>converter</code> 只支持命名函数。如果 mypy 发现其他内容，它会抱怨无法理解该参数，并且 <a href="https://docs.python.org/3/reference/datamodel.html#object.__init__">__init__</a> 中的类型注解将被替换为 <code>Any</code>。</p>
</li>
<li>
<p><a href="https://www.attrs.org/en/stable/examples.html#examples-validators">验证器装饰器</a> 和 <a href="https://www.attrs.org/en/stable/examples.html#defaults">默认值装饰器</a> 在设置/验证属性时不会进行类型检查。</p>
</li>
<li>
<p>mypy 添加的方法定义目前会覆盖任何现有的方法定义。</p>
</li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li>
<p>The detection of attr classes and attributes works by function name only. This means that if you have your own helper functions that, for example, <code>return attrs.field()</code> mypy will not see them.</p>
</li>
<li>
<p>All boolean arguments that mypy cares about must be literal <code>True</code> or <code>False</code>. e.g the following will not work:</p>
</li>
</ul>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">attrs</span>
YES <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #AA22FF">@attrs</span><span style="color: #666666">.</span>define(init<span style="color: #666666">=</span>YES)
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #666666">...</span>
</code></pre></div>
<ul>
<li>
<p>Currently, <code>converter</code> only supports named functions.  If mypy finds something else it will complain about not understanding the argument and the type annotation in <a href="https://docs.python.org/3/reference/datamodel.html#object.__init__">__init__</a> will be replaced by <code>Any</code>.</p>
</li>
<li>
<p><a href="https://www.attrs.org/en/stable/examples.html#examples-validators">Validator decorators</a> and <a href="https://www.attrs.org/en/stable/examples.html#defaults">default decorators</a> are not type-checked against the attribute they are setting/validating.</p>
</li>
<li>
<p>Method definitions added by mypy currently overwrite any existing method definitions.</p>
</li>
</ul>
</div>
</div>
</div>
<h2 id="使用远程缓存加速-mypy-运行">使用远程缓存加速 mypy 运行<a class="headerlink" href="#使用远程缓存加速-mypy-运行" title="Permanent link">&para;</a></h2>
<p><strong>Using a remote cache to speed up mypy runs</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Mypy 进行类型检查是 <em>递增式</em> 的，它重用之前运行的结果来加快后续运行的速度。如果你正在对一个大型代码库进行类型检查，mypy 有时仍可能比预期的慢。例如，如果你基于比上一次 mypy 运行目标提交更新得多的最新提交创建了一个新分支，mypy 可能需要处理几乎每个文件，因为很大一部分源文件可能已经更改。这种情况也可能在你对本地分支进行 rebase 后发生。</p>
<p>Mypy 支持使用 <em>远程缓存</em> 来提高性能，尤其是在上述情况中。在大型代码库中，远程缓存有时可以将 mypy 的运行速度提高 10 倍或更多。</p>
<p>Mypy 不包括设置所需的所有组件——通常你需要与 Continuous Integration (CI) 或构建系统进行一些简单的集成，以配置 mypy 使用远程缓存。以下讨论假设你已经为需要加速的 mypy 构建设置了 CI 系统，并且你正在使用中央 Git 仓库。将这些设置推广到不同的环境应该不难。</p>
<p>这里是所需的主要组件：</p>
<ul>
<li>
<p>一个用于存储所有已提交的 mypy 缓存文件的共享仓库。</p>
</li>
<li>
<p>一个 CI 构建，它在每次 CI 构建运行的提交中将 mypy 递增缓存文件上传到共享仓库。</p>
</li>
<li>
<p>一个包装脚本，开发者用它来运行启用了远程缓存的 mypy。</p>
</li>
</ul>
<p>下面我们将详细讨论每个组件。</p>
</div>
<div class="tabbed-block">
<p>Mypy performs type checking <em>incrementally</em>, reusing results from previous runs to speed up successive runs. If you are type checking a large codebase, mypy can still be sometimes slower than desirable. For example, if you create a new branch based on a much more recent commit than the target of the previous mypy run, mypy may have to process almost every file, as a large fraction of source files may have changed. This can also happen after you've rebased a local branch.</p>
<p>Mypy supports using a <em>remote cache</em> to improve performance in cases such as the above.  In a large codebase, remote caching can sometimes speed up mypy runs by a factor of 10, or more.</p>
<p>Mypy doesn't include all components needed to set this up -- generally you will have to perform some simple integration with your Continuous Integration (CI) or build system to configure mypy to use a remote cache. This discussion assumes you have a CI system set up for the mypy build you want to speed up, and that you are using a central git repository. Generalizing to different environments should not be difficult.</p>
<p>Here are the main components needed:</p>
<ul>
<li>
<p>A shared repository for storing mypy cache files for all landed commits.</p>
</li>
<li>
<p>CI build that uploads mypy incremental cache files to the shared repository for each commit for which the CI build runs.</p>
</li>
<li>
<p>A wrapper script around mypy that developers use to run mypy with remote caching enabled.</p>
</li>
</ul>
<p>Below we discuss each of these components in some detail.</p>
</div>
</div>
</div>
<h3 id="缓存文件的共享仓库">缓存文件的共享仓库<a class="headerlink" href="#缓存文件的共享仓库" title="Permanent link">&para;</a></h3>
<p><strong>Shared repository for cache files</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">中文</label><label for="__tabbed_8_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>你需要一个仓库，允许你从 CI 构建上传 mypy 缓存文件，并根据提交 ID 使缓存文件可供下载。一个简单的方法是将 <code>.mypy_cache</code> 目录（包含 mypy 缓存数据）制作成一个可下载的 <em>构建工件</em>，从你的 CI 构建中生成（这取决于你的 CI 系统的能力）。另外，你也可以将数据上传到一个 web 服务器或 S3 等存储服务。</p>
</div>
<div class="tabbed-block">
<p>You need a repository that allows you to upload mypy cache files from your CI build and make the cache files available for download based on a commit id.  A simple approach would be to produce an archive of the <code>.mypy_cache</code> directory (which contains the mypy cache data) as a downloadable <em>build artifact</em> from your CI build (depending on the capabilities of your CI system).  Alternatively, you could upload the data to a web server or to S3, for example.</p>
</div>
</div>
</div>
<h3 id="持续集成构建">持续集成构建<a class="headerlink" href="#持续集成构建" title="Permanent link">&para;</a></h3>
<p><strong>Continuous Integration build</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">中文</label><label for="__tabbed_9_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>CI 构建会运行常规的 mypy 构建，并创建一个包含构建产生的 <code>.mypy_cache</code> 目录的归档文件。最后，它会将缓存作为构建工件生成，或上传到一个仓库，使其可以被 mypy 包装脚本访问。</p>
<p>你的 CI 脚本可能如下工作：</p>
<ul>
<li>
<p>正常运行 mypy。这将生成位于 <code>.mypy_cache</code> 目录下的缓存数据。</p>
</li>
<li>
<p>从 <code>.mypy_cache</code> 目录创建一个 tarball 归档文件。</p>
</li>
<li>
<p>确定当前 Git 主分支的提交 ID（例如，使用 <code>git rev-parse HEAD</code>）。</p>
</li>
<li>
<p>将 tarball 上传到共享仓库，名称由提交 ID 派生。</p>
</li>
</ul>
</div>
<div class="tabbed-block">
<p>The CI build would run a regular mypy build and create an archive containing the <code>.mypy_cache</code> directory produced by the build. Finally, it will produce the cache as a build artifact or upload it to a repository where it is accessible by the mypy wrapper script.</p>
<p>Your CI script might work like this:</p>
<ul>
<li>
<p>Run mypy normally. This will generate cache data under the <code>.mypy_cache</code> directory.</p>
</li>
<li>
<p>Create a tarball from the <code>.mypy_cache</code> directory.</p>
</li>
<li>
<p>Determine the current git master branch commit id (say, using <code>git rev-parse HEAD</code>).</p>
</li>
<li>
<p>Upload the tarball to the shared repository with a name derived from the commit id.</p>
</li>
</ul>
</div>
</div>
</div>
<h3 id="mypy-包装脚本">Mypy 包装脚本<a class="headerlink" href="#mypy-包装脚本" title="Permanent link">&para;</a></h3>
<p><strong>Mypy wrapper script</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">中文</label><label for="__tabbed_10_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>包装脚本由开发人员在本地开发过程中使用，以替代直接调用 mypy。该包装脚本首先从共享仓库中填充本地的 <code>.mypy_cache</code> 目录，然后运行常规的增量构建。</p>
<p>包装脚本需要一些逻辑来确定本地开发分支所基于的最新中央仓库提交（按惯例为 git 的 <code>origin/master</code> 分支）。在典型的 git 设置中，你可以这样做：</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>git<span style="color: #bbbbbb"> </span>merge-base<span style="color: #bbbbbb"> </span>HEAD<span style="color: #bbbbbb"> </span>origin/master
</code></pre></div>
<p>下一步是根据上面 git 命令生成的合并基点的提交 ID，从共享仓库下载缓存数据（<code>.mypy_cache</code> 目录的内容）。脚本将解压缩数据，以便 mypy 从一个新的 <code>.mypy_cache</code> 开始。最后，脚本正常运行 mypy。就这样！</p>
</div>
<div class="tabbed-block">
<p>The wrapper script is used by developers to run mypy locally during development instead of invoking mypy directly.  The wrapper first populates the local <code>.mypy_cache</code> directory from the shared repository and then runs a normal incremental build.</p>
<p>The wrapper script needs some logic to determine the most recent central repository commit (by convention, the <code>origin/master</code> branch for git) the local development branch is based on. In a typical git setup you can do it like this:</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>git<span style="color: #bbbbbb"> </span>merge-base<span style="color: #bbbbbb"> </span>HEAD<span style="color: #bbbbbb"> </span>origin/master
</code></pre></div>
<p>The next step is to download the cache data (contents of the <code>.mypy_cache</code> directory) from the shared repository based on the commit id of the merge base produced by the git command above. The script will decompress the data so that mypy will start with a fresh <code>.mypy_cache</code>. Finally, the script runs mypy normally. And that's all!</p>
</div>
</div>
</div>
<h3 id="使用-mypy-守护进程进行缓存">使用 mypy 守护进程进行缓存<a class="headerlink" href="#使用-mypy-守护进程进行缓存" title="Permanent link">&para;</a></h3>
<p><strong>Caching with mypy daemon</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">中文</label><label for="__tabbed_11_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>你还可以使用 <a href="../../mypy_conf/mypy_daemon/">mypy 守护进程</a> 进行远程缓存。远程缓存将显著加快启动或重启守护进程后的第一次 <code>dmypy check</code> 运行速度。</p>
<p>mypy 守护进程需要缓存文件中额外的细粒度依赖数据，这些数据默认情况下不包括在内。要在 CI 构建中使用缓存与 mypy 守护进程，请使用 <a href="../../mypy_conf/command_line/#cache-fine-grained">--cache-fine-grained</a> 选项：</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>mypy<span style="color: #bbbbbb"> </span>--cache-fine-grained<span style="color: #bbbbbb"> </span>&lt;args...&gt;
</code></pre></div>
<p>此标志会向缓存中添加额外的信息，以供守护进程使用。为了利用这些额外的信息，你还需要在 <code>dmypy start</code> 或 <code>dmypy restart</code> 时使用 <code>--use-fine-grained-cache</code> 选项。例如：</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>dmypy<span style="color: #bbbbbb"> </span>start<span style="color: #bbbbbb"> </span>--<span style="color: #bbbbbb"> </span>--use-fine-grained-cache<span style="color: #bbbbbb"> </span>&lt;options...&gt;
</code></pre></div>
<p>现在，你的第一次 <code>dmypy check</code> 运行应该会快得多，因为它可以使用缓存信息来避免处理整个程序。</p>
</div>
<div class="tabbed-block">
<p>You can also use remote caching with the <a href="../../mypy_conf/mypy_daemon/">mypy daemon</a>. The remote cache will significantly speed up the first <code>dmypy check</code> run after starting or restarting the daemon.</p>
<p>The mypy daemon requires extra fine-grained dependency data in the cache files which aren't included by default. To use caching with the mypy daemon, use the <a href="../../mypy_conf/command_line/#cache-fine-grained">--cache-fine-grained</a> option in your CI build</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>mypy<span style="color: #bbbbbb"> </span>--cache-fine-grained<span style="color: #bbbbbb"> </span>&lt;args...&gt;
</code></pre></div>
<p>This flag adds extra information for the daemon to the cache. In order to use this extra information, you will also need to use the <code>--use-fine-grained-cache</code> option with <code>dmypy start</code> or <code>dmypy restart</code>. Example</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>dmypy<span style="color: #bbbbbb"> </span>start<span style="color: #bbbbbb"> </span>--<span style="color: #bbbbbb"> </span>--use-fine-grained-cache<span style="color: #bbbbbb"> </span>&lt;options...&gt;
</code></pre></div>
<p>Now your first <code>dmypy check</code> run should be much faster, as it can use cache information to avoid processing the whole program.</p>
</div>
</div>
</div>
<h3 id="改进">改进<a class="headerlink" href="#改进" title="Permanent link">&para;</a></h3>
<p><strong>Refinements</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">中文</label><label for="__tabbed_12_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>有几个可选的改进措施可以进一步提升性能，尤其是当你的代码库达到几十万行或更多时：</p>
<ul>
<li>
<p>如果包装脚本确定合并基点与之前的运行没有变化，那么就不需要下载缓存数据，而是最好重用现有的本地缓存数据。</p>
</li>
<li>
<p>如果你使用 mypy 守护进程，可能需要在每次合并基点或本地分支更改后重新启动守护进程，以避免在增量构建中处理大量更改，因为这比下载缓存数据和重启守护进程要慢得多。</p>
</li>
<li>
<p>如果当前本地分支基于非常新的 master 提交，远程缓存数据可能尚不可用，因为构建缓存文件会有一定的延迟。可以考虑查找例如最近 5 个 master 提交的缓存数据，并使用其中最可用的最新数据。</p>
</li>
<li>
<p>如果由于某些原因（例如，从公共网络访问）远程缓存无法访问，脚本仍然可以回退到常规的增量构建。</p>
</li>
<li>
<p>你可以为不同的本地分支设置多个本地缓存目录，使用 <a href="../../mypy_conf/command_line/#cache-dir">--cache-dir</a> 选项。如果用户切换到一个已有缓存数据的分支，可以继续使用现有的缓存数据，而不是重新下载数据。</p>
</li>
<li>
<p>你可以设置你的 CI 构建使用远程缓存来加速 CI 构建。这在每次 CI 构建从新状态开始且无法访问之前构建的缓存文件时尤其有用。仍然建议运行一次完整的非增量 mypy 构建以创建缓存数据，因为重复增量更新缓存数据可能会导致长期内的偏差（可能由于 mypy 缓存问题）。</p>
</li>
</ul>
</div>
<div class="tabbed-block">
<p>There are several optional refinements that may improve things further at least if your codebase is hundreds of thousands of lines or more:</p>
<ul>
<li>
<p>If the wrapper script determines that the merge base hasn't changed from a previous run, there's no need to download the cache data and it's better to instead reuse the existing local cache data.</p>
</li>
<li>
<p>If you use the mypy daemon, you may want to restart the daemon each time after the merge base or local branch has changed to avoid processing a potentially large number of changes in an incremental build, as this can be much slower than downloading cache data and restarting the daemon.</p>
</li>
<li>
<p>If the current local branch is based on a very recent master commit, the remote cache data may not yet be available for that commit, as there will necessarily be some latency to build the cache files. It may be a good idea to look for cache data for, say, the 5 latest master commits and use the most recent data that is available.</p>
</li>
<li>
<p>If the remote cache is not accessible for some reason (say, from a public network), the script can still fall back to a normal incremental build.</p>
</li>
<li>
<p>You can have multiple local cache directories for different local branches using the <a href="../../mypy_conf/command_line/#cache-dir">--cache-dir</a> option. If the user switches to an existing branch where downloaded cache data is already available, you can continue to use the existing cache data instead of redownloading the data.</p>
</li>
<li>
<p>You can set up your CI build to use a remote cache to speed up the CI build. This would be particularly useful if each CI build starts from a fresh state without access to cache files from previous builds. It's still recommended to run a full, non-incremental mypy build to create the cache data, as repeatedly updating cache data incrementally could result in drift over a long time period (due to a mypy caching issue, perhaps).</p>
</li>
</ul>
</div>
</div>
</div>
<h2 id="扩展的-callable-类型">扩展的 Callable 类型<a class="headerlink" href="#扩展的-callable-类型" title="Permanent link">&para;</a></h2>
<p><strong>Extended Callable types</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">中文</label><label for="__tabbed_13_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>此功能已弃用。你可以使用 <a href="../../mypy/protocol_and_struct_subtyping/">回调协议</a> 作为替代。</p>
</div>
<p>作为一个实验性的 mypy 扩展，你可以指定支持关键字参数、可选参数等的 <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> 类型。当你指定 <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> 的参数时，你可以选择仅提供一个无名位置参数的类型，或提供一个表示更复杂参数形式的“参数说明符”。这使得你可以更接近 Python 中 <code>def</code> 语句所提供的全部可能性。</p>
<p>例如，这里有一个复杂的函数定义及其对应的 <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Callable
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">mypy_extensions</span> <span style="color: #008000; font-weight: bold">import</span> (Arg, DefaultArg, NamedArg,
                            DefaultNamedArg, VarArg, KwArg)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">func</span>(__a: <span style="color: #008000">int</span>,  <span style="color: #3D7B7B; font-style: italic"># 这种约定用于无名参数</span>
        b: <span style="color: #008000">int</span>,
        c: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>,
        <span style="color: #666666">*</span>args: <span style="color: #008000">int</span>,
        d: <span style="color: #008000">int</span>,
        e: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>,
        <span style="color: #666666">**</span>kwargs: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
    <span style="color: #666666">...</span>

F <span style="color: #666666">=</span> Callable[[<span style="color: #008000">int</span>,  <span style="color: #3D7B7B; font-style: italic"># 或 Arg(int)</span>
            Arg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;b&#39;</span>),
            DefaultArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;c&#39;</span>),
            VarArg(<span style="color: #008000">int</span>),
            NamedArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;d&#39;</span>),
            DefaultNamedArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;e&#39;</span>),
            KwArg(<span style="color: #008000">int</span>)],
            <span style="color: #008000">int</span>]

f: F <span style="color: #666666">=</span> func
</code></pre></div>
<p>参数说明符是特殊的函数调用，用于指定参数的以下方面：</p>
<ul>
<li>
<p>其类型（基本格式仅支持此项）</p>
</li>
<li>
<p>其名称（如果有）</p>
</li>
<li>
<p>是否可以省略</p>
</li>
<li>
<p>是否可以或必须使用关键字传递</p>
</li>
<li>
<p>是否为 <code>*args</code> 参数（表示剩余的位置参数）</p>
</li>
<li>
<p>是否为 <code>**kwargs</code> 参数（表示剩余的关键字参数）</p>
</li>
</ul>
<p>以下是 <code>mypy_extensions</code> 中可用的函数：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Arg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># 一个普通的、强制的、位置参数。</span>
    <span style="color: #3D7B7B; font-style: italic"># 如果指定了名称，可以作为关键字传递。</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">DefaultArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># 一个可选的的位置参数（即有默认值）。</span>
    <span style="color: #3D7B7B; font-style: italic"># 如果指定了名称，可以作为关键字传递。</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">NamedArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># 一个强制的仅限关键字的参数。</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">DefaultNamedArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># 一个可选的仅限关键字的参数（即有默认值）。</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">VarArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any):
    <span style="color: #3D7B7B; font-style: italic"># 一个 *args 风格的可变位置参数。</span>
    <span style="color: #3D7B7B; font-style: italic"># 一个 VarArg() 说明符表示所有剩余的位置参数。</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">KwArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any):
    <span style="color: #3D7B7B; font-style: italic"># 一个 **kwargs 风格的可变关键字参数。</span>
    <span style="color: #3D7B7B; font-style: italic"># 一个 KwArg() 说明符表示所有剩余的关键字参数。</span>
</code></pre></div>
<p>在所有情况下，<code>type</code> 参数默认为 <code>Any</code>，如果省略 <code>name</code> 参数，则该参数没有名称（<code>NamedArg</code> 和 <code>DefaultNamedArg</code> 需要名称）。一个基本的 <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> 如下：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyFunc <span style="color: #666666">=</span> Callable[[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">int</span>], <span style="color: #008000">float</span>]
</code></pre></div>
<p>等同于：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyFunc <span style="color: #666666">=</span> Callable[[Arg(<span style="color: #008000">int</span>), Arg(<span style="color: #008000">str</span>), Arg(<span style="color: #008000">int</span>)], <span style="color: #008000">float</span>]
</code></pre></div>
<p>一个具有未指定参数类型的 <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>，如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyOtherFunc <span style="color: #666666">=</span> Callable[<span style="color: #666666">...</span>, <span style="color: #008000">int</span>]
</code></pre></div>
<p>（大致）等同于：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyOtherFunc <span style="color: #666666">=</span> Callable[[VarArg(), KwArg()], <span style="color: #008000">int</span>]
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>上述每个函数目前在运行时仅返回其 <code>type</code> 参数，因此参数说明符中包含的信息在运行时不可用。这一限制是为了与 Python 3.5+ 标准库中的现有 <code>typing.py</code> 模块及通过 PyPI 分发的模块保持向后兼容。</p>
</div>
</div>
<div class="tabbed-block">
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature is deprecated.  You can use</p>
</div>
<p><a href="../../mypy/protocol_and_struct_subtyping/">callback protocols</a> as a replacement.</p>
<p>As an experimental mypy extension, you can specify <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> types that support keyword arguments, optional arguments, and more.  When you specify the arguments of a <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, you can choose to supply just the type of a nameless positional argument, or an "argument specifier" representing a more complicated form of argument.  This allows one to more closely emulate the full range of possibilities given by the <code>def</code> statement in Python.</p>
<p>As an example, here's a complicated function definition and the corresponding <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Callable
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">mypy_extensions</span> <span style="color: #008000; font-weight: bold">import</span> (Arg, DefaultArg, NamedArg,
                            DefaultNamedArg, VarArg, KwArg)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">func</span>(__a: <span style="color: #008000">int</span>,  <span style="color: #3D7B7B; font-style: italic"># This convention is for nameless arguments</span>
        b: <span style="color: #008000">int</span>,
        c: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>,
        <span style="color: #666666">*</span>args: <span style="color: #008000">int</span>,
        d: <span style="color: #008000">int</span>,
        e: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>,
        <span style="color: #666666">**</span>kwargs: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
    <span style="color: #666666">...</span>

F <span style="color: #666666">=</span> Callable[[<span style="color: #008000">int</span>,  <span style="color: #3D7B7B; font-style: italic"># Or Arg(int)</span>
            Arg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;b&#39;</span>),
            DefaultArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;c&#39;</span>),
            VarArg(<span style="color: #008000">int</span>),
            NamedArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;d&#39;</span>),
            DefaultNamedArg(<span style="color: #008000">int</span>, <span style="color: #BA2121">&#39;e&#39;</span>),
            KwArg(<span style="color: #008000">int</span>)],
            <span style="color: #008000">int</span>]

f: F <span style="color: #666666">=</span> func
</code></pre></div>
<p>Argument specifiers are special function calls that can specify the following aspects of an argument:</p>
<ul>
<li>
<p>its type (the only thing that the basic format supports)</p>
</li>
<li>
<p>its name (if it has one)</p>
</li>
<li>
<p>whether it may be omitted</p>
</li>
<li>
<p>whether it may or must be passed using a keyword</p>
</li>
<li>
<p>whether it is a <code>*args</code> argument (representing the remaining positional arguments)</p>
</li>
<li>
<p>whether it is a <code>**kwargs</code> argument (representing the remaining keyword arguments)</p>
</li>
</ul>
<p>The following functions are available in <code>mypy_extensions</code> for this purpose:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Arg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># A normal, mandatory, positional argument.</span>
    <span style="color: #3D7B7B; font-style: italic"># If the name is specified it may be passed as a keyword.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">DefaultArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># An optional positional argument (i.e. with a default value).</span>
    <span style="color: #3D7B7B; font-style: italic"># If the name is specified it may be passed as a keyword.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">NamedArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># A mandatory keyword-only argument.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">DefaultNamedArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any, name<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>):
    <span style="color: #3D7B7B; font-style: italic"># An optional keyword-only argument (i.e. with a default value).</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">VarArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any):
    <span style="color: #3D7B7B; font-style: italic"># A *args-style variadic positional argument.</span>
    <span style="color: #3D7B7B; font-style: italic"># A single VarArg() specifier represents all remaining</span>
    <span style="color: #3D7B7B; font-style: italic"># positional arguments.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">KwArg</span>(<span style="color: #008000">type</span><span style="color: #666666">=</span>Any):
    <span style="color: #3D7B7B; font-style: italic"># A **kwargs-style variadic keyword argument.</span>
    <span style="color: #3D7B7B; font-style: italic"># A single KwArg() specifier represents all remaining</span>
    <span style="color: #3D7B7B; font-style: italic"># keyword arguments.</span>
</code></pre></div>
<p>In all cases, the <code>type</code> argument defaults to <code>Any</code>, and if the <code>name</code> argument is omitted the argument has no name (the name is required for <code>NamedArg</code> and <code>DefaultNamedArg</code>).  A basic <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> such as</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyFunc <span style="color: #666666">=</span> Callable[[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">int</span>], <span style="color: #008000">float</span>]
</code></pre></div>
<p>is equivalent to the following:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyFunc <span style="color: #666666">=</span> Callable[[Arg(<span style="color: #008000">int</span>), Arg(<span style="color: #008000">str</span>), Arg(<span style="color: #008000">int</span>)], <span style="color: #008000">float</span>]
</code></pre></div>
<p>A <a href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a> with unspecified argument types, such as</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyOtherFunc <span style="color: #666666">=</span> Callable[<span style="color: #666666">...</span>, <span style="color: #008000">int</span>]
</code></pre></div>
<p>is (roughly) equivalent to</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>MyOtherFunc <span style="color: #666666">=</span> Callable[[VarArg(), KwArg()], <span style="color: #008000">int</span>]
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each of the functions above currently just returns its <code>type</code> argument at runtime, so the information contained in the argument specifiers is not available at runtime.  This limitation is necessary for backwards compatibility with the existing <code>typing.py</code> module as present in the Python 3.5+ standard library and distributed via PyPI.</p>
</div>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月17日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月13日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>