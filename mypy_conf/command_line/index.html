
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="hellowac-类型检查">
      
      
      
      
        <link rel="prev" href="../running_mypy/">
      
      
        <link rel="next" href="../config_file/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>mypy命令行 - mypy静态类型检查器</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mypy-命令行" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="mypy静态类型检查器" class="md-header__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mypy静态类型检查器
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mypy命令行
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  欢迎来到mypy文档!

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy/" class="md-tabs__link">
          
  
    
  
  第一步

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy/builtin_types/" class="md-tabs__link">
          
  
    
  
  类型系统参考

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  配置和运行mypy

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy_other/" class="md-tabs__link">
          
  
    
  
  其他杂项

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../mypy_other/project_links/" class="md-tabs__link">
        
  
    
  
  项目链接

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mypy静态类型检查器" class="md-nav__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    mypy静态类型检查器
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欢迎来到mypy文档!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    第一步
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            第一步
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/cheat_sheet_py3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型提示备忘录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/existing_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将 mypy 与现有代码库结合使用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    类型系统参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            类型系统参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/builtin_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内置类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/type_inference_type_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型推断和类型注解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/kind_of_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型种类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/class_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类的基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/annotation_issue_at_runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行时的注解问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/protocol_and_struct_subtyping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    协议及其子类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/dynamic_typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    动态类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/type_narrowing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型收缩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/duck_type_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    鸭子类型兼容
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/stub_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    存根文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/generics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泛型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/more_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    更多类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/literal_and_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    字面量和枚举
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/typeddict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型字典
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/final_names_methods_classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最终名称、方法和类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy/metaclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    元类
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    配置和运行mypy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            配置和运行mypy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../running_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行mypy和管理导入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    mypy命令行
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    mypy命令行
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#指定需要类型检查的内容" class="md-nav__link">
    指定需要类型检查的内容
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#可选参数" class="md-nav__link">
    可选参数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置文件" class="md-nav__link">
    配置文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#导入发现" class="md-nav__link">
    导入发现
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#平台配置" class="md-nav__link">
    平台配置
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#禁止动态类型" class="md-nav__link">
    禁止动态类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#未类型化的定义与调用" class="md-nav__link">
    未类型化的定义与调用
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#none-和-optional-的处理" class="md-nav__link">
    None 和 Optional 的处理
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置警告warnings" class="md-nav__link">
    配置警告(warnings)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#其他严格性标志" class="md-nav__link">
    其他严格性标志
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置错误消息" class="md-nav__link">
    配置错误消息
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#增量模式" class="md-nav__link">
    增量模式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#高级选项" class="md-nav__link">
    高级选项
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#报告生成" class="md-nav__link">
    报告生成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#启用不完整或实验性功能" class="md-nav__link">
    启用不完整或实验性功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#其他" class="md-nav__link">
    其他
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../config_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy配置文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../inline_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内联配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../mypy_daemon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy服务(守护进程)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../installed_packages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用安装包
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../extending_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    扩展和集成 mypy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../stubgen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../stubtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根测试
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy_other/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    其他杂项
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            其他杂项
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/common_issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题及解决办法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/supported_python_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    支持的 Python 特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_code_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    默认启用的错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_code_list2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    可选检查的错误代码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/additional_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    额外特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题解答
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/project_links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    项目链接
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#指定需要类型检查的内容" class="md-nav__link">
    指定需要类型检查的内容
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#可选参数" class="md-nav__link">
    可选参数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置文件" class="md-nav__link">
    配置文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#导入发现" class="md-nav__link">
    导入发现
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#平台配置" class="md-nav__link">
    平台配置
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#禁止动态类型" class="md-nav__link">
    禁止动态类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#未类型化的定义与调用" class="md-nav__link">
    未类型化的定义与调用
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#none-和-optional-的处理" class="md-nav__link">
    None 和 Optional 的处理
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置警告warnings" class="md-nav__link">
    配置警告(warnings)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#其他严格性标志" class="md-nav__link">
    其他严格性标志
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#配置错误消息" class="md-nav__link">
    配置错误消息
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#增量模式" class="md-nav__link">
    增量模式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#高级选项" class="md-nav__link">
    高级选项
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#报告生成" class="md-nav__link">
    报告生成
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#启用不完整或实验性功能" class="md-nav__link">
    启用不完整或实验性功能
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#其他" class="md-nav__link">
    其他
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="mypy-命令行">mypy 命令行<a class="headerlink" href="#mypy-命令行" title="Permanent link">&para;</a></h1>
<p><strong>The mypy command line</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>本节文档介绍了 mypy 的命令行接口。你可以通过运行 <a href="#h">mypy --help</a> 查看可用标志的简要总结。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>命令行标志可能会在不同版本之间发生变化。</p>
</div>
</div>
<div class="tabbed-block">
<p>This section documents mypy's command line interface. You can view a quick summary of the available flags by running <a href="#h">mypy --help</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Command line flags are liable to change between releases.</p>
</div>
</div>
</div>
</div>
<h2 id="指定需要类型检查的内容">指定需要类型检查的内容<a class="headerlink" href="#指定需要类型检查的内容" title="Permanent link">&para;</a></h2>
<p><strong>Specifying what to type check</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>默认情况下，你可以通过传递路径来指定要让 mypy 进行类型检查的代码：</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>mypy<span style="color: #bbbbbb"> </span>foo.py<span style="color: #bbbbbb"> </span>bar.py<span style="color: #bbbbbb"> </span>some_directory
</code></pre></div>
<p>请注意，目录会被递归检查。</p>
<p>Mypy 还允许你通过其他几种方式指定要检查的代码。以下是相关标志的简要总结：有关详细信息，请参阅 <a href="../running_mypy/">running-mypy</a>。</p>
<dl>
<dt><span id="m"></span><code>-m MODULE, --module MODULE</code></dt>
<dd>
<p>请求 mypy 检查提供的模块。这个标志可以重复使用多次。</p>
<p>Mypy <em>不会</em> 递归地检查提供模块的任何子模块。</p>
</dd>
<dt><span id="p"></span><code>-p PACKAGE, --package PACKAGE</code></dt>
<dd>
<p>请求 mypy 检查提供的包。这个标志可以重复使用多次。</p>
<p>Mypy <em>会</em> 递归地检查提供包的所有子模块。这个标志与 <a href="#m">--module</a> 的唯一区别在于这种行为。</p>
</dd>
<dt><span id="c"></span><code>-c PROGRAM_TEXT, --command PROGRAM_TEXT</code></dt>
<dd>
<p>请求 mypy 将提供的字符串作为程序进行类型检查。</p>
</dd>
<dt><span id="exclude"></span><code>--exclude</code></dt>
<dd>
<p>一个正则表达式，用于匹配文件名、目录名和路径，my py 在递归发现要检查的文件时应忽略这些匹配的内容。在所有平台上使用正斜杠。</p>
<p>例如，为了避免发现任何名为 <code>setup.py</code> 的文件，你可以使用 <code>--exclude '/setup\.py$'</code>。类似地，你可以通过例如 <code>--exclude /build/</code> 忽略具有特定名称的目录，或通过 <code>--exclude /project/vendor/</code> 忽略匹配子路径的目录。要忽略多个文件/目录/路径，你可以多次提供 --exclude 标志，例如 <code>--exclude '/setup\.py$' --exclude '/build/'</code>。</p>
<p>请注意，这个标志只影响递归目录树发现，也就是说，当 mypy 在目录树或包的子模块中发现文件时会被忽略。如果你明确地传递了文件或模块，它仍然会被检查。例如，<code>mypy --exclude '/setup.py$' but_still_check/setup.py</code>。</p>
<p>特别是，<code>--exclude</code> 不影响 mypy 的 <a href="../running_mypy/#跟随导入">导入跟随</a>。你可以使用每模块的 <a href="../config_file/#follow_imports">follow_imports</a> 配置选项，额外避免 mypy 跟随导入并检查你不希望检查的代码。</p>
<p>请注意，mypy 永远不会递归发现名为 "site-packages"、"node_modules" 或 "__pycache__" 的文件和目录，或名称以点号开头的文件夹，就像 <code>--exclude '/(site-packages|node_modules|__pycache__|\..*)/$'</code> 所做的那样。Mypy 也不会递归发现扩展名不是 <code>.py</code> 或 <code>.pyi</code> 的文件。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>By default, you can specify what code you want mypy to type check by passing in the paths to what you want to have type checked</p>
<div class="language-shell highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>$<span style="color: #bbbbbb"> </span>mypy<span style="color: #bbbbbb"> </span>foo.py<span style="color: #bbbbbb"> </span>bar.py<span style="color: #bbbbbb"> </span>some_directory
</code></pre></div>
<p>Note that directories are checked recursively.</p>
<p>Mypy also lets you specify what code to type check in several other ways. A short summary of the relevant flags is included below: for full details, see <a href="../running_mypy/">running-mypy</a>.</p>
<dl>
<dt><span id="m"></span><code>-m MODULE, --module MODULE</code></dt>
<dd>
<p>Asks mypy to type check the provided module. This flag may be repeated multiple times.</p>
<p>Mypy <em>will not</em> recursively type check any submodules of the provided module.</p>
</dd>
<dt><span id="p"></span><code>-p PACKAGE, --package PACKAGE</code></dt>
<dd>
<p>Asks mypy to type check the provided package. This flag may be repeated multiple times.</p>
<p>Mypy <em>will</em> recursively type check any submodules of the provided package. This flag is identical to <a href="#m">--module</a> apart from this behavior.</p>
</dd>
<dt><span id="c"></span><code>-c PROGRAM_TEXT, --command PROGRAM_TEXT</code></dt>
<dd>
<p>Asks mypy to type check the provided string as a program.</p>
</dd>
<dt><span id="exclude"></span><code>--exclude</code></dt>
<dd>
<p>A regular expression that matches file names, directory names and paths which mypy should ignore while recursively discovering files to check. Use forward slashes on all platforms.</p>
<p>For instance, to avoid discovering any files named <code>setup.py</code> you could pass <code>--exclude '/setup\.py$'</code>. Similarly, you can ignore discovering directories with a given name by e.g. <code>--exclude /build/</code> or those matching a subpath with <code>--exclude /project/vendor/</code>. To ignore multiple files / directories / paths, you can provide the --exclude flag more than once, e.g <code>--exclude '/setup\.py$' --exclude '/build/'</code>.</p>
<p>Note that this flag only affects recursive directory tree discovery, that is, when mypy is discovering files within a directory tree or submodules of a package to check. If you pass a file or module explicitly it will still be checked. For instance, <code>mypy --exclude '/setup.py$' but_still_check/setup.py</code>.</p>
<p>In particular, <code>--exclude</code> does not affect mypy's <a href="../running_mypy/#跟随导入">import following</a>. You can use a per-module <a href="../config_file/#follow_imports">follow_imports</a> config option to additionally avoid mypy from following imports and checking code you do not wish to be checked.</p>
<p>Note that mypy will never recursively discover files and directories named "site-packages", "node_modules" or "__pycache__", or those whose name starts with a period, exactly as <code>--exclude '/(site-packages|node_modules|__pycache__|\..*)/$'</code> would. Mypy will also never recursively discover files with extensions other than <code>.py</code> or <code>.pyi</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="可选参数">可选参数<a class="headerlink" href="#可选参数" title="Permanent link">&para;</a></h2>
<p><strong>Optional arguments</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<dl>
<dt><span id="h"></span><code>-h, --help</code></dt>
<dd>
<p>显示帮助信息并退出。</p>
</dd>
<dt><span id="v"></span><code>-v, --verbose</code></dt>
<dd>
<p>显示更详细的消息。</p>
</dd>
<dt><span id="V"></span><code>-V, --version</code></dt>
<dd>
<p>显示程序的版本号并退出。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<dl>
<dt><span id="h"></span><code>-h, --help</code></dt>
<dd>
<p>Show help message and exit.</p>
</dd>
<dt><span id="v"></span><code>-v, --verbose</code></dt>
<dd>
<p>More verbose messages.</p>
</dd>
<dt><span id="V"></span><code>-V, --version</code></dt>
<dd>
<p>Show program's version number and exit.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="配置文件">配置文件<a class="headerlink" href="#配置文件" title="Permanent link">&para;</a></h2>
<p><strong>Config file</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<dl>
<dt><span id="config-file"></span><code>--config-file CONFIG_FILE</code></dt>
<dd>
<p>该选项使 mypy 从指定的配置文件中读取配置设置。</p>
<p>默认情况下，设置会从当前目录下的 <code>mypy.ini</code>, <code>.mypy.ini</code>, <code>pyproject.toml</code> 或 <code>setup.cfg</code> 文件中读取。配置设置会覆盖 mypy 的内置默认值，而命令行标志可以覆盖这些设置。</p>
<p>指定 <a href="#config-file">config-file=</a>（不带文件名）将忽略 <em>所有</em> 配置文件。</p>
<p>有关配置文件的语法，请参见 <a href="../config_file/">config-file</a>。</p>
</dd>
<dt><span id="warn-unused-configs"></span><code>--warn-unused-configs</code></dt>
<dd>
<p>该选项使 mypy 对未使用的 <code>[mypy-&lt;pattern&gt;]</code> 配置文件部分发出警告。（这需要使用 <a href="#no-incremental">--no-incremental</a> 关闭增量模式。）</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<dl>
<dt><span id="config-file"></span><code>--config-file CONFIG_FILE</code></dt>
<dd>
<p>This flag makes mypy read configuration settings from the given file.</p>
<p>By default settings are read from <code>mypy.ini</code>, <code>.mypy.ini</code>, <code>pyproject.toml</code>, or <code>setup.cfg</code> in the current directory. Settings override mypy's built-in defaults and command line flags can override settings.</p>
<p>Specifying <a href="#config-file">config-file=</a>(with no filename) will ignore <em>all</em> config files.</p>
<p>See <a href="../config_file/">config-file</a> for the syntax of configuration files.</p>
</dd>
<dt><span id="warn-unused-configs"></span><code>--warn-unused-configs</code></dt>
<dd>
<p>This flag makes mypy warn about unused <code>[mypy-&lt;pattern&gt;]</code> config file sections. (This requires turning off incremental mode using <a href="#no-incremental">--no-incremental</a>.)</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="导入发现">导入发现<a class="headerlink" href="#导入发现" title="Permanent link">&para;</a></h2>
<p><strong>Import discovery</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下选项用于自定义 mypy 发现和跟随导入的具体方式。</p>
<dl>
<dt><span id="explicit-package-bases"></span><code>--explicit-package-bases</code></dt>
<dd>
<p>该选项告诉 mypy 顶级包将基于当前目录，或者 <code>MYPYPATH</code> 环境变量或 <a href="../config_file/#mypy_path">mypy_path</a> 配置选项的成员。此选项仅在缺少 <code>__init__.py</code> 文件时有用。有关详细信息，请参见 <a href="../running_mypy/#映射文件路径到模块">Mapping file paths to modules</a>。</p>
</dd>
<dt><span id="ignore-missing-imports"></span><code>--ignore-missing-imports</code></dt>
<dd>
<p>该选项使 mypy 忽略所有缺失的导入。这相当于在代码库中的所有未解析导入处添加 <code># type: ignore</code> 注释。</p>
<p>请注意，此选项 <em>不会</em> 抑制关于成功解析的模块中缺失名称的错误。例如，如果有以下文件</p>
<p><div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>package/__init__.py
package/mod.py
</code></pre></div>
那么使用 <a href="#ignore-missing-imports">--ignore-missing-imports</a> 时，mypy 将生成以下错误：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">package.unknown</span>      <span style="color: #3D7B7B; font-style: italic"># 无错误，已忽略</span>
x <span style="color: #666666">=</span> package<span style="color: #666666">.</span>unknown<span style="color: #666666">.</span>func()  <span style="color: #3D7B7B; font-style: italic"># OK. &#39;func&#39; 被假定为 &#39;Any&#39; 类型</span>

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">package</span> <span style="color: #008000; font-weight: bold">import</span> unknown          <span style="color: #3D7B7B; font-style: italic"># 无错误，已忽略</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">package.mod</span> <span style="color: #008000; font-weight: bold">import</span> NonExisting  <span style="color: #3D7B7B; font-style: italic"># 错误: 模块没有属性 &#39;NonExisting&#39;</span>
</code></pre></div>
<p>更多细节，请参见 <a href="../running_mypy/#缺失的导入">ignore-missing-imports</a>。</p>
</dd>
<dt><span id="follow-imports"></span><code>--follow-imports {normal,silent,skip,error}</code></dt>
<dd>
<p>该选项调整 mypy 如何跟随通过命令行未明确传入的导入模块。</p>
<p>默认选项是 <code>normal</code>：mypy 将跟随并类型检查所有模块。有关其他选项的作用，请参见 <a href="../running_mypy/#跟随导入">Following imports</a>。</p>
</dd>
<dt><span id="python-executable"></span><code>--python-executable EXECUTABLE</code></dt>
<dd>
<p>该选项使 mypy 从为 Python 可执行文件 <code>EXECUTABLE</code> 安装的 <a href="https://peps.python.org/pep-0561/">PEP 561</a> 兼容包中收集类型信息。如果未提供，mypy 将使用为运行 mypy 的 Python 可执行文件安装的 PEP 561 兼容包。</p>
<p>有关如何制作 PEP 561 兼容包的更多信息，请参见 <a href="../installed_packages/">installed-packages</a>。</p>
</dd>
<dt><span id="no-site-packages"></span><code>--no-site-packages</code></dt>
<dd>
<p>该选项将禁用对 <a href="https://peps.python.org/pep-0561/">PEP 561</a> 兼容包的搜索。这也将禁用对可用 Python 可执行文件的搜索。</p>
<p>如果 mypy 无法找到适用于检查的 Python 版本的 Python 可执行文件，并且不需要使用 PEP 561 类型的包，请使用此选项。否则，请使用 <a href="#python-executable">--python-executable</a>。</p>
</dd>
<dt><span id="no-silence-site-packages"></span><code>--no-silence-site-packages</code></dt>
<dd>
<p>默认情况下，mypy 会抑制在 <a href="https://peps.python.org/pep-0561/">PEP 561</a> 兼容包中生成的任何错误消息。添加此选项将禁用此行为。</p>
</dd>
<dt><span id="fast-module-lookup"></span><code>--fast-module-lookup</code></dt>
<dd>
<p>默认逻辑用于扫描搜索路径以解析导入，在某些情况下具有二次最坏情况行为，例如，由大量共享顶级命名空间的文件夹触发，如下所示</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>    foo/
        company/
            foo/
                a.py
    bar/
        company/
            bar/
                b.py
    baz/
        company/
            baz/
                c.py
    ...
</code></pre></div>
<p>如果你遇到这种情况，可以通过设置 <a href="#fast-module-lookup">--fast-module-lookup</a> 选项启用实验性的快速路径。</p>
</dd>
<dt><span id="no-namespace-packages"></span><code>--no-namespace-packages</code></dt>
<dd>
<p>该选项禁用对命名空间包的导入发现（见 <a href="https://peps.python.org/pep-0420/">PEP 420</a>）。特别是，这会防止发现没有 <code>__init__.py</code>（或 <code>__init__.pyi</code>）文件的包。</p>
<p>该选项影响 mypy 如何找到在命令行上明确传递的模块和包。它也影响 mypy 如何确定传递在命令行上的文件的完全限定模块名称。有关详细信息，请参见 <a href="../running_mypy/#映射文件路径到模块">Mapping file paths to modules</a>。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags customize how exactly mypy discovers and follows imports.</p>
<dl>
<dt><span id="explicit-package-bases"></span><code>--explicit-package-bases</code></dt>
<dd>
<p>This flag tells mypy that top-level packages will be based in either the current directory, or a member of the <code>MYPYPATH</code> environment variable or <a href="../config_file/#mypy_path">mypy_path</a> config option. This option is only useful in the absence of <code>__init__.py</code>. See <a href="../running_mypy/#映射文件路径到模块">Mapping file paths to modules</a> for details.</p>
</dd>
<dt><span id="ignore-missing-imports"></span><code>--ignore-missing-imports</code></dt>
<dd>
<p>This flag makes mypy ignore all missing imports. It is equivalent to adding <code># type: ignore</code> comments to all unresolved imports within your codebase.</p>
<p>Note that this flag does <em>not</em> suppress errors about missing names in successfully resolved modules. For example, if one has the following files</p>
<p><div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>package/__init__.py
package/mod.py
</code></pre></div>
Then mypy will generate the following errors with <a href="#ignore-missing-imports">--ignore-missing-imports</a>:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">package.unknown</span>      <span style="color: #3D7B7B; font-style: italic"># No error, ignored</span>
x <span style="color: #666666">=</span> package<span style="color: #666666">.</span>unknown<span style="color: #666666">.</span>func()  <span style="color: #3D7B7B; font-style: italic"># OK. &#39;func&#39; is assumed to be of type &#39;Any&#39;</span>

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">package</span> <span style="color: #008000; font-weight: bold">import</span> unknown          <span style="color: #3D7B7B; font-style: italic"># No error, ignored</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">package.mod</span> <span style="color: #008000; font-weight: bold">import</span> NonExisting  <span style="color: #3D7B7B; font-style: italic"># Error: Module has no attribute &#39;NonExisting&#39;</span>
</code></pre></div>
<p>For more details, see <a href="../running_mypy/#缺失的导入">ignore-missing-imports</a>.</p>
</dd>
<dt><span id="follow-imports"></span><code>--follow-imports {normal,silent,skip,error}</code></dt>
<dd>
<p>This flag adjusts how mypy follows imported modules that were not explicitly passed in via the command line.</p>
<p>The default option is <code>normal</code>: mypy will follow and type check all modules. For more information on what the other options do, see <a href="../running_mypy/#跟随导入">Following imports</a>.</p>
</dd>
<dt><span id="python-executable"></span><code>--python-executable EXECUTABLE</code></dt>
<dd>
<p>This flag will have mypy collect type information from <a href="https://peps.python.org/pep-0561/">PEP 561</a> compliant packages installed for the Python executable <code>EXECUTABLE</code>. If not provided, mypy will use PEP 561 compliant packages installed for the Python executable running mypy.</p>
<p>See <a href="../installed_packages/">installed-packages</a> for more on making PEP 561 compliant packages.</p>
</dd>
<dt><span id="no-site-packages"></span><code>--no-site-packages</code></dt>
<dd>
<p>This flag will disable searching for <a href="https://peps.python.org/pep-0561/">PEP 561</a> compliant packages. This
will also disable searching for a usable Python executable.</p>
<p>Use this  flag if mypy cannot find a Python executable for the version of Python being checked, and you don't need to use PEP 561 typed packages. Otherwise, use <a href="#python-executable">--python-executable</a>.</p>
</dd>
<dt><span id="no-silence-site-packages"></span><code>--no-silence-site-packages</code></dt>
<dd>
<p>By default, mypy will suppress any error messages generated within <a href="https://peps.python.org/pep-0561/">PEP 561</a> compliant packages. Adding this flag will disable this behavior.</p>
</dd>
<dt><span id="fast-module-lookup"></span><code>--fast-module-lookup</code></dt>
<dd>
<p>The default logic used to scan through search paths to resolve imports has a quadratic worse-case behavior in some cases, which is for instance triggered by a large number of folders sharing a top-level namespace as in</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>    foo/
        company/
            foo/
                a.py
    bar/
        company/
            bar/
                b.py
    baz/
        company/
            baz/
                c.py
    ...
</code></pre></div>
<p>If you are in this situation, you can enable an experimental fast path by setting the <a href="#fast-module-lookup">--fast-module-lookup</a> option.</p>
</dd>
<dt><span id="no-namespace-packages"></span><code>--no-namespace-packages</code></dt>
<dd>
<p>This flag disables import discovery of namespace packages (see <a href="https://peps.python.org/pep-0420/">PEP 420</a>). In particular, this prevents discovery of packages that don't have an <code>__init__.py</code> (or <code>__init__.pyi</code>) file.</p>
<p>This flag affects how mypy finds modules and packages explicitly passed on the command line. It also affects how mypy determines fully qualified module names for files passed on the command line. See <a href="../running_mypy/#映射文件路径到模块">Mapping file paths to modules</a> for details.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="平台配置">平台配置<a class="headerlink" href="#平台配置" title="Permanent link">&para;</a></h2>
<p><strong>Platform configuration</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>默认情况下，mypy 会假定你打算使用与运行 mypy 本身相同的操作系统和 Python 版本来运行你的代码。以下选项允许你修改这一行为。</p>
<p>有关如何使用这些选项的更多信息，请参见 <a href="../../mypy_other/common_issues/#python-版本和系统平台检查">Python version and system platform checks</a>。</p>
<dl>
<dt><span id="python-version"></span><code>--python-version X.Y</code></dt>
<dd>
<p>该选项将使 mypy 在类型检查你的代码时假定它在 Python 版本 X.Y 下运行。如果没有此选项，mypy 将默认使用运行 mypy 的 Python 版本。</p>
<p>此选项会尝试查找对应版本的 Python 可执行文件，以搜索符合 <a href="https://peps.python.org/pep-0561/">PEP 561</a> 的包。如果你想禁用此功能，可以使用 <a href="#no-site-packages">--no-site-packages</a> 选项（有关更多细节，请参见 <a href="#导入发现">import-discovery</a>）。</p>
</dd>
<dt><span id="platform"></span><code>--platform PLATFORM</code></dt>
<dd>
<p>该选项将使 mypy 在类型检查你的代码时假定它在指定的操作系统下运行。如果没有此选项，mypy 将默认使用你当前使用的操作系统。</p>
<p><code>PLATFORM</code> 参数可以是 <a href="https://docs.python.org/3/library/sys.html#sys.platform">sys.platform</a> 支持的任何字符串。</p>
</dd>
<dt><span id="always-true"></span><code>--always-true NAME</code></dt>
<dd>
<p>该选项将把所有名为 <code>NAME</code> 的变量视为始终为真（compile-time constants）。此选项可以重复使用。</p>
</dd>
<dt><span id="always-false"></span><code>--always-false NAME</code></dt>
<dd>
<p>该选项将把所有名为 <code>NAME</code> 的变量视为始终为假（compile-time constants）。此选项可以重复使用。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>By default, mypy will assume that you intend to run your code using the same operating system and Python version you are using to run mypy itself. The following flags let you modify this behavior.</p>
<p>For more information on how to use these flags, see <a href="../../mypy_other/common_issues/#python-版本和系统平台检查">Python version and system platform checks</a>.</p>
<dl>
<dt><span id="python-version"></span><code>--python-version X.Y</code></dt>
<dd>
<p>This flag will make mypy type check your code as if it were run under Python version X.Y. Without this option, mypy will default to using whatever version of Python is running mypy.</p>
<p>This flag will attempt to find a Python executable of the corresponding version to search for <a href="https://peps.python.org/pep-0561/">PEP 561</a> compliant packages. If you'd like to disable this, use the <a href="#no-site-packages">--no-site-packages</a> flag (see <a href="#导入发现">import-discovery</a> for more details).</p>
</dd>
<dt><span id="platform"></span><code>--platform PLATFORM</code></dt>
<dd>
<p>This flag will make mypy type check your code as if it were run under the given operating system. Without this option, mypy will default to using whatever operating system you are currently using.</p>
<p>The <code>PLATFORM</code> parameter may be any string supported by <a href="https://docs.python.org/3/library/sys.html#sys.platform">sys.platform</a>.</p>
</dd>
<dt><span id="always-true"></span><code>--always-true NAME</code></dt>
<dd>
<p>This flag will treat all variables named <code>NAME</code> as compile-time constants that are always true.  This flag may be repeated.</p>
</dd>
<dt><span id="always-false"></span><code>--always-false NAME</code></dt>
<dd>
<p>This flag will treat all variables named <code>NAME</code> as compile-time constants that are always false.  This flag may be repeated.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="禁止动态类型">禁止动态类型<a class="headerlink" href="#禁止动态类型" title="Permanent link">&para;</a></h2>
<p><strong>Disallow dynamic typing</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><code>Any</code> 类型用于表示具有 <a href="../../mypy/dynamic_typing/">动态类型</a> 的值。<code>--disallow-any</code> 系列标志可以禁止在模块中使用 <code>Any</code> 类型，这样可以在受控的方式下战略性地禁用动态类型。</p>
<p>以下是可用的选项：</p>
<dl>
<dt><span id="disallow-any-unimported"></span><code>--disallow-any-unimported</code></dt>
<dd>
<p>该选项禁止使用来自未跟随导入的类型（这些类型会被视作 <code>Any</code> 的别名）。未跟随的导入发生在以下两种情况之一：导入的模块不存在，或者设置了 <a href="#follow-imports">--follow-imports=skip</a>。</p>
</dd>
<dt><span id="disallow-any-expr"></span><code>--disallow-any-expr</code></dt>
<dd>
<p>该选项禁止模块中所有类型为 <code>Any</code> 的表达式。如果模块中出现了类型为 <code>Any</code> 的表达式，除非该表达式立即用作 <a href="https://docs.python.org/3/library/typing.html#typing.cast">cast()</a> 的参数或赋值给具有显式类型注解的变量，否则 mypy 将输出错误。</p>
<p>此外，声明 <code>Any</code> 类型的变量或强制转换为 <code>Any</code> 类型也是不允许的。请注意，调用接受 <code>Any</code> 类型参数的函数仍然是允许的。</p>
</dd>
<dt><span id="disallow-any-decorated"></span><code>--disallow-any-decorated</code></dt>
<dd>
<p>该选项禁止在装饰器转换后具有 <code>Any</code> 类型的函数。</p>
</dd>
<dt><span id="disallow-any-explicit"></span><code>--disallow-any-explicit</code></dt>
<dd>
<p>该选项禁止在类型注解和泛型类型参数等类型位置上显式使用 <code>Any</code>。</p>
</dd>
<dt><span id="disallow-any-generics"></span><code>--disallow-any-generics</code></dt>
<dd>
<p>该选项禁止使用未指定显式类型参数的泛型类型。例如，你不能使用裸的 <code>x: list</code>，而必须始终写成类似 <code>x: list[int]</code> 的形式。</p>
</dd>
<dt><span id="disallow-subclassing-any"></span><code>--disallow-subclassing-any</code></dt>
<dd>
<p>该选项报告错误，当一个类继承了类型为 <code>Any</code> 的值时。 这可能发生在基类从一个不存在的模块中导入（当使用 <a href="#ignore-missing-imports">--ignore-missing-imports</a>）或由于 <a href="#follow-imports">--follow-imports=skip</a> 或 <code>import</code> 语句上的 <code># type: ignore</code> 注释而被忽略时。</p>
<p>由于模块被静默处理，导入的类被赋予 <code>Any</code> 类型。默认情况下，mypy 会假设子类正确地继承了基类，尽管实际情况可能并非如此。此选项会使 mypy 报告错误。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The <code>Any</code> type is used to represent a value that has a <a href="../../mypy/dynamic_typing/">dynamic type</a>. The <code>--disallow-any</code> family of flags will disallow various uses of the <code>Any</code> type in a module -- this lets us strategically disallow the use of dynamic typing in a controlled way.</p>
<p>The following options are available:</p>
<dl>
<dt><span id="disallow-any-unimported"></span><code>--disallow-any-unimported</code></dt>
<dd>
<p>This flag disallows usage of types that come from unfollowed imports (such types become aliases for <code>Any</code>). Unfollowed imports occur either when the imported module does not exist or when <a href="#follow-imports">--follow-imports=skip</a> is set.</p>
</dd>
<dt><span id="disallow-any-expr"></span><code>--disallow-any-expr</code></dt>
<dd>
<p>This flag disallows all expressions in the module that have type <code>Any</code>. If an expression of type <code>Any</code> appears anywhere in the module mypy will output an error unless the expression is immediately used as an argument to <a href="https://docs.python.org/3/library/typing.html#typing.cast">cast()</a> or assigned to a variable with an explicit type annotation.</p>
<p>In addition, declaring a variable of type <code>Any</code> or casting to type <code>Any</code> is not allowed. Note that calling functions that take parameters of type <code>Any</code> is still allowed.</p>
</dd>
<dt><span id="disallow-any-decorated"></span><code>--disallow-any-decorated</code></dt>
<dd>
<p>This flag disallows functions that have <code>Any</code> in their signature after decorator transformation.</p>
</dd>
<dt><span id="disallow-any-explicit"></span><code>--disallow-any-explicit</code></dt>
<dd>
<p>This flag disallows explicit <code>Any</code> in type positions such as type annotations and generic type parameters.</p>
</dd>
<dt><span id="disallow-any-generics"></span><code>--disallow-any-generics</code></dt>
<dd>
<p>This flag disallows usage of generic types that do not specify explicit type parameters. For example, you can't use a bare <code>x: list</code>. Instead, you must always write something like <code>x: list[int]</code>.</p>
</dd>
<dt><span id="disallow-subclassing-any"></span><code>--disallow-subclassing-any</code></dt>
<dd>
<p>This flag reports an error whenever a class subclasses a value of type <code>Any</code>.  This may occur when the base class is imported from a module that doesn't exist (when using <a href="#ignore-missing-imports">--ignore-missing-imports</a>) or is ignored due to <a href="#follow-imports">--follow-imports=skip</a> or a <code># type: ignore</code> comment on the <code>import</code> statement.</p>
<p>Since the module is silenced, the imported class is given a type of <code>Any</code>. By default mypy will assume that the subclass correctly inherited the base class even though that may not actually be the case.  This flag makes mypy raise an error instead.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="未类型化的定义与调用">未类型化的定义与调用<a class="headerlink" href="#未类型化的定义与调用" title="Permanent link">&para;</a></h2>
<p><strong>Untyped definitions and calls</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">中文</label><label for="__tabbed_8_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志用于配置 mypy 处理未类型注解的函数定义或调用的方式。</p>
<dl>
<dt><span id="disallow-untyped-calls"></span><code>--disallow-untyped-calls</code></dt>
<dd>
<p>该标志在函数调用时，如果调用的函数没有类型注解，则会报告错误。此选项适用于具有类型注解的函数调用未注解的函数。</p>
</dd>
<dt><span id="untyped-calls-exclude"></span><code>--untyped-calls-exclude</code></dt>
<dd>
<p>该标志允许选择性地禁用 <a href="#disallow-untyped-calls">--disallow-untyped-calls</a> 对特定包、模块或类中定义的函数和方法的限制。请注意，每个排除条目作为前缀进行匹配。例如（假设没有可用的 <code>third_party_lib</code> 类型注解）：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># mypy --disallow-untyped-calls</span>
<span style="color: #3D7B7B; font-style: italic">#      --untyped-calls-exclude=third_party_lib.module_a</span>
<span style="color: #3D7B7B; font-style: italic">#      --untyped-calls-exclude=foo.A</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">third_party_lib.module_a</span> <span style="color: #008000; font-weight: bold">import</span> some_func
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">third_party_lib.module_b</span> <span style="color: #008000; font-weight: bold">import</span> other_func
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">foo</span>

some_func()  <span style="color: #3D7B7B; font-style: italic"># OK, 函数来自模块 `third_party_lib.module_a`</span>
other_func()  <span style="color: #3D7B7B; font-style: italic"># E: 在类型化上下文中调用未注解的函数 &quot;other_func&quot;</span>

foo<span style="color: #666666">.</span>A()<span style="color: #666666">.</span>meth()  <span style="color: #3D7B7B; font-style: italic"># OK, 方法定义在类 `foo.A` 中</span>
foo<span style="color: #666666">.</span>B()<span style="color: #666666">.</span>meth()  <span style="color: #3D7B7B; font-style: italic"># E: 在类型化上下文中调用未注解的函数 &quot;meth&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># 文件 foo.py</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">meth</span>(<span style="color: #008000">self</span>): <span style="color: #008000; font-weight: bold">pass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">B</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">meth</span>(<span style="color: #008000">self</span>): <span style="color: #008000; font-weight: bold">pass</span>
</code></pre></div>
</dd>
<dt><span id="disallow-untyped-defs"></span><code>--disallow-untyped-defs</code></dt>
<dd>
<p>该标志在遇到未注解或注解不完整的函数定义时报告错误。它是 <a href="#disallow-incomplete-defs">--disallow-incomplete-defs</a> 的超集。</p>
<p>例如，它会对 <code>def f(a, b)</code> 和 <code>def f(a: int, b)</code> 报告错误。</p>
</dd>
<dt><span id="disallow-incomplete-defs"></span><code>--disallow-incomplete-defs</code></dt>
<dd>
<p>该标志在遇到部分注解的函数定义时报告错误，但允许完全未注解的定义。</p>
<p>例如，它会对 <code>def f(a: int, b)</code> 报告错误，但不会对 <code>def f(a, b)</code> 报告错误。</p>
</dd>
<dt><span id="check-untyped-defs"></span><code>--check-untyped-defs</code></dt>
<dd>
<p>该标志比前两个选项的限制宽松 -- 它会对每个函数的主体进行类型检查，无论函数是否具有类型注解。（默认情况下，未注解的函数主体不会进行类型检查。）</p>
<p>它会假设所有参数的类型为 <code>Any</code>，并且始终推断返回类型为 <code>Any</code>。</p>
</dd>
<dt><span id="disallow-untyped-decorators"></span><code>--disallow-untyped-decorators</code></dt>
<dd>
<p>该标志在具有类型注解的函数被未注解的装饰器装饰时报告错误。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags configure how mypy handles untyped function definitions or calls.</p>
<dl>
<dt><span id="disallow-untyped-calls"></span><code>--disallow-untyped-calls</code></dt>
<dd>
<p>This flag reports an error whenever a function with type annotations calls a function defined without annotations.</p>
</dd>
<dt><span id="untyped-calls-exclude"></span><code>--untyped-calls-exclude</code></dt>
<dd>
<p>This flag allows to selectively disable <a href="#disallow-untyped-calls">--disallow-untyped-calls</a> for functions and methods defined in specific packages, modules, or classes. Note that each exclude entry acts as a prefix. For example (assuming there are no type annotations for <code>third_party_lib</code> available):</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># mypy --disallow-untyped-calls</span>
<span style="color: #3D7B7B; font-style: italic">#      --untyped-calls-exclude=third_party_lib.module_a</span>
<span style="color: #3D7B7B; font-style: italic">#      --untyped-calls-exclude=foo.A</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">third_party_lib.module_a</span> <span style="color: #008000; font-weight: bold">import</span> some_func
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">third_party_lib.module_b</span> <span style="color: #008000; font-weight: bold">import</span> other_func
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">foo</span>

some_func()  <span style="color: #3D7B7B; font-style: italic"># OK, function comes from module `third_party_lib.module_a`</span>
other_func()  <span style="color: #3D7B7B; font-style: italic"># E: Call to untyped function &quot;other_func&quot; in typed context</span>

foo<span style="color: #666666">.</span>A()<span style="color: #666666">.</span>meth()  <span style="color: #3D7B7B; font-style: italic"># OK, method was defined in class `foo.A`</span>
foo<span style="color: #666666">.</span>B()<span style="color: #666666">.</span>meth()  <span style="color: #3D7B7B; font-style: italic"># E: Call to untyped function &quot;meth&quot; in typed context</span>

<span style="color: #3D7B7B; font-style: italic"># file foo.py</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">meth</span>(<span style="color: #008000">self</span>): <span style="color: #008000; font-weight: bold">pass</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">B</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">meth</span>(<span style="color: #008000">self</span>): <span style="color: #008000; font-weight: bold">pass</span>
</code></pre></div>
</dd>
<dt><span id="disallow-untyped-defs"></span><code>--disallow-untyped-defs</code></dt>
<dd>
<p>This flag reports an error whenever it encounters a function definition
without type annotations or with incomplete type annotations.
(a superset of <a href="#disallow-incomplete-defs">--disallow-incomplete-defs</a>).</p>
<p>For example, it would report an error for <code>def f(a, b)</code> and <code>def f(a: int, b)</code>.</p>
</dd>
<dt><span id="disallow-incomplete-defs"></span><code>--disallow-incomplete-defs</code></dt>
<dd>
<p>This flag reports an error whenever it encounters a partly annotated function definition, while still allowing entirely unannotated definitions.</p>
<p>For example, it would report an error for <code>def f(a: int, b)</code> but not <code>def f(a, b)</code>.</p>
</dd>
<dt><span id="check-untyped-defs"></span><code>--check-untyped-defs</code></dt>
<dd>
<p>This flag is less severe than the previous two options -- it type checks the body of every function, regardless of whether it has type annotations. (By default the bodies of functions without annotations are not type checked.)</p>
<p>It will assume all arguments have type <code>Any</code> and always infer <code>Any</code> as the return type.</p>
</dd>
<dt><span id="disallow-untyped-decorators"></span><code>--disallow-untyped-decorators</code></dt>
<dd>
<p>This flag reports an error whenever a function with type annotations is decorated with a decorator without annotations.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="none-和-optional-的处理">None 和 Optional 的处理<a class="headerlink" href="#none-和-optional-的处理" title="Permanent link">&para;</a></h2>
<p><strong>None and Optional handling</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">中文</label><label for="__tabbed_9_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志调整 mypy 处理类型为 <code>None</code> 的值的方式。</p>
<dl>
<dt><span id="implicit-optional"></span><code>--implicit-optional</code></dt>
<dd>
<p>该标志使 mypy 将具有 <code>None</code> 默认值的参数视为具有隐式的 <a href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a> 类型。</p>
<p>例如，如果设置了此标志，则在下面的代码片段中，mypy 将假设 <code>x</code> 参数实际上是 <code>Optional[int]</code> 类型，因为默认参数是 <code>None</code>：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">foo</span>(x: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000">print</span>(x)
</code></pre></div>
<p><strong>注意：</strong> 从 mypy 0.980 开始，此功能默认被禁用。</p>
</dd>
<dt><span id="no-strict-optional"></span><code>--no-strict-optional</code></dt>
<dd>
<p>该标志有效地禁用对 <a href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a> 类型和 <code>None</code> 值的检查。启用此选项后，mypy 通常不会检查 <code>None</code> 值的使用 -- 它被视为与所有类型兼容。</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>--no-strict-optional</code> 是不推荐的。避免使用此选项，并且在不了解其作用的情况下绝对不要使用它。</p>
</div>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags adjust how mypy handles values of type <code>None</code>.</p>
<dl>
<dt><span id="implicit-optional"></span><code>--implicit-optional</code></dt>
<dd>
<p>This flag causes mypy to treat arguments with a <code>None</code> default value as having an implicit <a href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a> type.</p>
<p>For example, if this flag is set, mypy would assume that the <code>x</code> parameter is actually of type <code>Optional[int]</code> in the code snippet below since the default parameter is <code>None</code>:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">foo</span>(x: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000">print</span>(x)
</code></pre></div>
<p><strong>Note:</strong> This was disabled by default starting in mypy 0.980.</p>
</dd>
<dt><span id="no-strict-optional"></span><code>--no-strict-optional</code></dt>
<dd>
<p>This flag effectively disables checking of <a href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a> types and <code>None</code> values. With this option, mypy doesn't generally check the use of <code>None</code> values -- it is treated as compatible with every type.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>--no-strict-optional</code> is evil. Avoid using it and definitely do not use it without understanding what it does.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="配置警告warnings">配置警告(warnings)<a class="headerlink" href="#配置警告warnings" title="Permanent link">&para;</a></h2>
<p><strong>Configuring warnings</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">中文</label><label for="__tabbed_10_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志用于启用对代码的警告，这些代码在语义上是正确的，但可能存在潜在问题或冗余。</p>
<dl>
<dt><span id="warn-redundant-casts"></span><code>--warn-redundant-casts</code></dt>
<dd>
<p>该标志使 mypy 在代码中使用了不必要的类型转换时报告错误，这些转换可以安全地移除。</p>
</dd>
<dt><span id="warn-unused-ignores"></span><code>--warn-unused-ignores</code></dt>
<dd>
<p>该标志使 mypy 在代码中使用了 <code># type: ignore</code> 注释的行没有实际生成错误消息时报告错误。</p>
<p>该标志和 <a href="#warn-redundant-casts">--warn-redundant-casts</a> 标志在升级 mypy 时特别有用。之前，可能需要添加类型转换或 <code># type: ignore</code> 注释来绕过 mypy 中的错误或缺少第三方库的类型存根。</p>
<p>这两个标志帮助您发现那些不再需要的修复方法。</p>
</dd>
<dt><span id="no-warn-no-return"></span><code>--no-warn-no-return</code></dt>
<dd>
<p>默认情况下，当函数在某些执行路径中缺少返回语句时，mypy 会生成错误。唯一的例外是：</p>
<ul>
<li>函数的返回类型为 <code>None</code> 或 <code>Any</code></li>
<li>函数的主体为空，并且标记为抽象方法、在协议类中或在存根文件中</li>
<li>执行路径永远不会返回，例如总是抛出异常</li>
</ul>
<p>使用 <a href="#no-warn-no-return">--no-warn-no-return</a> 选项将禁用所有情况下的这些错误消息。</p>
</dd>
<dt><span id="warn-return-any"></span><code>--warn-return-any</code></dt>
<dd>
<p>该标志使 mypy 在从一个声明了非 <code>Any</code> 返回类型的函数中返回类型为 <code>Any</code> 的值时生成警告。</p>
</dd>
<dt><span id="warn-unreachable"></span><code>--warn-unreachable</code></dt>
<dd>
<p>该标志使 mypy 在执行类型分析后遇到被确定为不可达或冗余的代码时报告错误。这是检测代码中某些类型错误的有用方法。</p>
<p>例如，启用此标志将使 mypy 报告 <code>x &gt; 7</code> 检查是冗余的，并且以下的 <code>else</code> 块是不可达的。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(x: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># 错误: &quot;or&quot; 的右操作数永远不会被评估</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(x, <span style="color: #008000">int</span>) <span style="color: #AA22FF; font-weight: bold">or</span> x <span style="color: #666666">&gt;</span> <span style="color: #666666">7</span>:
        <span style="color: #3D7B7B; font-style: italic"># 错误: 不支持的操作数类型 for + (&quot;int&quot; 和 &quot;str&quot;)</span>
        <span style="color: #008000">print</span>(x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bad&quot;</span>)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #3D7B7B; font-style: italic"># 错误: &#39;语句不可达&#39; 错误</span>
        <span style="color: #008000">print</span>(x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bad&quot;</span>)
</code></pre></div>
<p>为了帮助防止 mypy 生成虚假的警告，“语句不可达”警告将在以下两种情况下被静默：</p>
<ol>
<li>当不可达的语句是 <code>raise</code> 语句、<code>assert False</code> 语句，或调用具有 <a href="https://docs.python.org/3/library/typing.html#typing.NoReturn">NoReturn</a> 返回类型提示的函数时。换句话说，当不可达的语句抛出错误或以某种方式终止程序时。</li>
<li>当不可达的语句被 <em>故意</em> 标记为不可达时，使用 <a href="../../mypy_other/common_issues/#python-版本和系统平台检查">Python 版本和系统平台检查</a>。</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>目前 mypy 无法检测和报告使用 <a href="../../mypy/generics/#具有值限制的类型变量">值限制的类型变量</a> 的任何函数内部的不可达或冗余代码。</p>
<p>这种限制将在 future 版本的 mypy 中移除。</p>
</div>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags enable warnings for code that is sound but is potentially problematic or redundant in some way.</p>
<dl>
<dt><span id="warn-redundant-casts"></span><code>--warn-redundant-casts</code></dt>
<dd>
<p>This flag will make mypy report an error whenever your code uses an unnecessary cast that can safely be removed.</p>
</dd>
<dt><span id="warn-unused-ignores"></span><code>--warn-unused-ignores</code></dt>
<dd>
<p>This flag will make mypy report an error whenever your code uses a <code># type: ignore</code> comment on a line that is not actually generating an error message.</p>
<p>This flag, along with the <a href="#warn-redundant-casts">--warn-redundant-casts</a> flag, are both particularly useful when you are upgrading mypy. Previously, you may have needed to add casts or <code># type: ignore</code> annotations to work around bugs in mypy or missing stubs for 3<sup>rd</sup> party libraries.</p>
<p>These two flags let you discover cases where either workarounds are no longer necessary.</p>
</dd>
<dt><span id="no-warn-no-return"></span><code>--no-warn-no-return</code></dt>
<dd>
<p>By default, mypy will generate errors when a function is missing return statements in some execution paths. The only exceptions are when:</p>
<ul>
<li>The function has a <code>None</code> or <code>Any</code> return type</li>
<li>The function has an empty body and is marked as an abstract method, is in a protocol class, or is in a stub file</li>
<li>The execution path can never return; for example, if an exception is always raised</li>
</ul>
<p>Passing in <a href="#no-warn-no-return">--no-warn-no-return</a> will disable these error messages in all cases.</p>
</dd>
<dt><span id="warn-return-any"></span><code>--warn-return-any</code></dt>
<dd>
<p>This flag causes mypy to generate a warning when returning a value with type <code>Any</code> from a function declared with a non-<code>Any</code> return type.</p>
</dd>
<dt><span id="warn-unreachable"></span><code>--warn-unreachable</code></dt>
<dd>
<p>This flag will make mypy report an error whenever it encounters code determined to be unreachable or redundant after performing type analysis. This can be a helpful way of detecting certain kinds of bugs in your code.</p>
<p>For example, enabling this flag will make mypy report that the <code>x &gt; 7</code> check is redundant and that the <code>else</code> block below is unreachable.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(x: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># Error: Right operand of &quot;or&quot; is never evaluated</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(x, <span style="color: #008000">int</span>) <span style="color: #AA22FF; font-weight: bold">or</span> x <span style="color: #666666">&gt;</span> <span style="color: #666666">7</span>:
        <span style="color: #3D7B7B; font-style: italic"># Error: Unsupported operand types for + (&quot;int&quot; and &quot;str&quot;)</span>
        <span style="color: #008000">print</span>(x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bad&quot;</span>)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #3D7B7B; font-style: italic"># Error: &#39;Statement is unreachable&#39; error</span>
        <span style="color: #008000">print</span>(x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bad&quot;</span>)
</code></pre></div>
<p>To help prevent mypy from generating spurious warnings, the "Statement is unreachable" warning will be silenced in exactly two cases:</p>
<ol>
<li>When the unreachable statement is a <code>raise</code> statement, is an <code>assert False</code> statement, or calls a function that has the <a href="https://docs.python.org/3/library/typing.html#typing.NoReturn">NoReturn</a> return type hint. In other words, when the unreachable statement throws an error or terminates the program in some way.</li>
<li>When the unreachable statement was <em>intentionally</em> marked as unreachable using <a href="../../mypy_other/common_issues/#python-版本和系统平台检查">Python version and system platform checks</a>.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mypy currently cannot detect and report unreachable or redundant code inside any functions using <a href="../../mypy/generics/#具有值限制的类型变量"> Type variables with value restriction</a>.</p>
<p>This limitation will be removed in future releases of mypy.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="其他严格性标志">其他严格性标志<a class="headerlink" href="#其他严格性标志" title="Permanent link">&para;</a></h2>
<p><strong>Miscellaneous strictness flags</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">中文</label><label for="__tabbed_11_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志用于配置 mypy 处理不符合上述任何部分的情况。</p>
<dl>
<dt><span id="allow-untyped-globals"></span><code>--allow-untyped-globals</code></dt>
<dd>
<p>该标志使 mypy 抑制因无法完全推断全局和类变量类型而产生的错误。</p>
</dd>
<dt><span id="allow-redefinition"></span><code>--allow-redefinition</code></dt>
<dd>
<p>默认情况下，mypy 不允许将变量重新定义为不相关的类型。此标志启用在某些上下文中重新定义变量为任意类型：仅允许在与原始定义相同的块和嵌套深度内的重新定义。例如，以下代码可能会有所帮助：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(items: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># &#39;items&#39; 的类型是 list[str]</span>
    items <span style="color: #666666">=</span> [item<span style="color: #666666">.</span>split() <span style="color: #008000; font-weight: bold">for</span> item <span style="color: #AA22FF; font-weight: bold">in</span> items]
    <span style="color: #3D7B7B; font-style: italic"># 现在 &#39;items&#39; 的类型是 list[list[str]]</span>
</code></pre></div>
<p>变量必须在重新定义之前被使用：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(items: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    items <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;mypy&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># 无效的重新定义为 str，因为变量尚未使用</span>
    <span style="color: #008000">print</span>(items)
    items <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;100&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># 有效，items 现在是 str 类型</span>
    items <span style="color: #666666">=</span> <span style="color: #008000">int</span>(items)  <span style="color: #3D7B7B; font-style: italic"># 有效，items 现在是 int 类型</span>
</code></pre></div>
</dd>
<dt><span id="local-partial-types"></span><code>--local-partial-types</code></dt>
<dd>
<p>在 mypy 中，最常见的部分类型情况是使用 <code>None</code> 初始化的变量，但没有显式的 <code>Optional</code> 注解。默认情况下，mypy 不会检查跨模块顶层或类顶层的部分类型。此标志更改了行为，只允许在局部级别进行部分类型，因此不允许在不同作用域中的两个赋值推断变量类型。例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Optional

a <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># 如果使用 --local-partial-types，这里需要类型注解</span>
b: Optional[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Foo</span>:
    bar <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># 如果使用 --local-partial-types，这里需要类型注解</span>
    baz: Optional[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>bar <span style="color: #666666">=</span> <span style="color: #666666">1</span>

reveal_type(Foo()<span style="color: #666666">.</span>bar)  <span style="color: #3D7B7B; font-style: italic"># 如果没有 --local-partial-types，会是 Union[int, None]</span>
</code></pre></div>
<p>注意：此选项在 mypy 守护进程中始终隐式启用，并且将在未来的 mypy 版本中默认启用。</p>
</dd>
<dt><span id="no-implicit-reexport"></span><code>--no-implicit-reexport</code></dt>
<dd>
<p>默认情况下，导入到模块的值被视为已导出，mypy 允许其他模块导入它们。此标志更改了行为，只有当项目使用 <code>from-as</code> 导入或包含在 <code>__all__</code> 中时才会重新导出。注意，这在存根文件中始终被视为启用。例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 这不会重新导出值</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar

<span style="color: #3D7B7B; font-style: italic"># 这也不会</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar <span style="color: #008000; font-weight: bold">as</span> bang

<span style="color: #3D7B7B; font-style: italic"># 这将重新导出为 bar 并允许其他模块导入</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar <span style="color: #008000; font-weight: bold">as</span> bar

<span style="color: #3D7B7B; font-style: italic"># 这也将重新导出 bar</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar
__all__ <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;bar&#39;</span>]
</code></pre></div>
</dd>
<dt><span id="strict-equality"></span><code>--strict-equality</code></dt>
<dd>
<p>默认情况下，mypy 允许像 <code>42 == 'no'</code> 这样的永远为假的比较。使用此标志可以禁止这种非重叠类型的比较，以及类似的身份和容器检查：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Text

items: <span style="color: #008000">list</span>[<span style="color: #008000">int</span>]
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&#39;some string&#39;</span> <span style="color: #AA22FF; font-weight: bold">in</span> items:  <span style="color: #3D7B7B; font-style: italic"># 错误: 非重叠容器检查！</span>
    <span style="color: #666666">...</span>

text: Text
<span style="color: #008000; font-weight: bold">if</span> text <span style="color: #666666">!=</span> <span style="color: #BA2121">b&#39;other bytes&#39;</span>:  <span style="color: #3D7B7B; font-style: italic"># 错误: 非重叠等于检查！</span>
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">assert</span> text <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># OK，检查 None 是允许的特例。</span>
</code></pre></div>
</dd>
<dt><span id="extra-checks"></span><code>--extra-checks</code></dt>
<dd>
<p>该标志启用额外的检查，这些检查在技术上是正确的，但在实际代码中可能不太实用。特别地，它禁止 <code>TypedDict</code> 更新中的部分重叠，并使通过 <code>Concatenate</code> 传递的参数仅限于位置参数。例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> TypedDict

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Foo</span>(TypedDict):
    a: <span style="color: #008000">int</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Bar</span>(TypedDict):
    a: <span style="color: #008000">int</span>
    b: <span style="color: #008000">int</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test</span>(foo: Foo, bar: Bar) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># 这在技术上是不安全的，因为 foo 可以在运行时具有 Foo 的子类型，</span>
    <span style="color: #3D7B7B; font-style: italic"># 其中键 &quot;b&quot; 的类型与 int 不兼容，如下所示</span>
    bar<span style="color: #666666">.</span>update(foo)

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Bad</span>(Foo):
    b: <span style="color: #008000">str</span>
bad: Bad <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;a&quot;</span>: <span style="color: #666666">0</span>, <span style="color: #BA2121">&quot;b&quot;</span>: <span style="color: #BA2121">&quot;no&quot;</span>}
test(bad, bar)
</code></pre></div>
</dd>
<dt><span id="strict"></span><code>--strict</code></dt>
<dd>
<p>此标志模式启用所有可选错误检查标志。您可以在完整的 <a href="#h">mypy --help</a> 输出中查看严格模式启用的标志列表。</p>
<p>注意：运行 <a href="#strict">--strict</a> 启用的标志的确切列表可能会随着时间而变化。</p>
</dd>
<dt><span id="disable-error-code"></span><code>--disable-error-code</code></dt>
<dd>
<p>该标志允许全局禁用一个或多个错误代码。有关更多信息，请参阅 <a href="../../mypy_other/error_codes/">错误代码</a>。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 无标志</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()  <span style="color: #3D7B7B; font-style: italic"># 错误: &quot;str&quot; 没有属性 &quot;trim&quot;  [attr-defined]</span>

<span style="color: #3D7B7B; font-style: italic"># 使用 --disable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()
</code></pre></div>
</dd>
<dt><span id="enable-error-code"></span><code>--enable-error-code</code></dt>
<dd>
<p>该标志允许全局启用一个或多个错误代码。有关更多信息，请参阅 <a href="../../mypy_other/error_codes/">错误代码</a>。</p>
<p>注意：此标志将覆盖 <a href="#disable-error-code">--disable-error-code</a> 标志中禁用的错误代码。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 使用 --disable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()

<span style="color: #3D7B7B; font-style: italic"># --disable-error-code attr-defined --enable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()  <span style="color: #3D7B7B; font-style: italic"># 错误: &quot;str&quot; 没有属性 &quot;trim&quot;  [attr-defined]</span>
</code></pre></div>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>This section documents any other flags that do not neatly fall under any of the above sections.</p>
<dl>
<dt><span id="allow-untyped-globals"></span><code>--allow-untyped-globals</code></dt>
<dd>
<p>This flag causes mypy to suppress errors caused by not being able to fully infer the types of global and class variables.</p>
</dd>
<dt><span id="allow-redefinition"></span><code>--allow-redefinition</code></dt>
<dd>
<p>By default, mypy won't allow a variable to be redefined with an unrelated type. This flag enables redefinition of a variable with an arbitrary type <em>in some contexts</em>: only redefinitions within the same block and nesting depth as the original definition are allowed. Example where this can be useful:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(items: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># &#39;items&#39; has type list[str]</span>
    items <span style="color: #666666">=</span> [item<span style="color: #666666">.</span>split() <span style="color: #008000; font-weight: bold">for</span> item <span style="color: #AA22FF; font-weight: bold">in</span> items]
    <span style="color: #3D7B7B; font-style: italic"># &#39;items&#39; now has type list[list[str]]</span>
</code></pre></div>
<p>The variable must be used before it can be redefined:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process</span>(items: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    items <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;mypy&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># invalid redefinition to str because the variable hasn&#39;t been used yet</span>
    <span style="color: #008000">print</span>(items)
    items <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;100&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># valid, items now has type str</span>
    items <span style="color: #666666">=</span> <span style="color: #008000">int</span>(items)  <span style="color: #3D7B7B; font-style: italic"># valid, items now has type int</span>
</code></pre></div>
</dd>
<dt><span id="local-partial-types"></span><code>--local-partial-types</code></dt>
<dd>
<p>In mypy, the most common cases for partial types are variables initialized using <code>None</code>, but without explicit <code>Optional</code> annotations. By default, mypy won't check partial types spanning module top level or class top level. This flag changes the behavior to only allow partial types at local level, therefore it disallows inferring variable type for <code>None</code> from two assignments in different scopes. For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Optional

a <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># Need type annotation here if using --local-partial-types</span>
b: Optional[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Foo</span>:
    bar <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># Need type annotation here if using --local-partial-types</span>
    baz: Optional[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>bar <span style="color: #666666">=</span> <span style="color: #666666">1</span>

reveal_type(Foo()<span style="color: #666666">.</span>bar)  <span style="color: #3D7B7B; font-style: italic"># Union[int, None] without --local-partial-types</span>
</code></pre></div>
<p>Note: this option is always implicitly enabled in mypy daemon and will become enabled by default for mypy in a future release.</p>
</dd>
<dt><span id="no-implicit-reexport"></span><code>--no-implicit-reexport</code></dt>
<dd>
<p>By default, imported values to a module are treated as exported and mypy allows other modules to import them. This flag changes the behavior to not re-export unless the item is imported using from-as or is included in <code>__all__</code>. Note this is always treated as enabled for stub files. For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># This won&#39;t re-export the value</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar

<span style="color: #3D7B7B; font-style: italic"># Neither will this</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar <span style="color: #008000; font-weight: bold">as</span> bang

<span style="color: #3D7B7B; font-style: italic"># This will re-export it as bar and allow other modules to import it</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar <span style="color: #008000; font-weight: bold">as</span> bar

<span style="color: #3D7B7B; font-style: italic"># This will also re-export bar</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">foo</span> <span style="color: #008000; font-weight: bold">import</span> bar
__all__ <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;bar&#39;</span>]
</code></pre></div>
</dd>
<dt><span id="strict-equality"></span><code>--strict-equality</code></dt>
<dd>
<p>By default, mypy allows always-false comparisons like <code>42 == 'no'</code>. Use this flag to prohibit such comparisons of non-overlapping types, and similar identity and container checks:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Text

items: <span style="color: #008000">list</span>[<span style="color: #008000">int</span>]
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&#39;some string&#39;</span> <span style="color: #AA22FF; font-weight: bold">in</span> items:  <span style="color: #3D7B7B; font-style: italic"># Error: non-overlapping container check!</span>
    <span style="color: #666666">...</span>

text: Text
<span style="color: #008000; font-weight: bold">if</span> text <span style="color: #666666">!=</span> <span style="color: #BA2121">b&#39;other bytes&#39;</span>:  <span style="color: #3D7B7B; font-style: italic"># Error: non-overlapping equality check!</span>
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">assert</span> text <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>  <span style="color: #3D7B7B; font-style: italic"># OK, check against None is allowed as a special case.</span>
</code></pre></div>
</dd>
<dt><span id="extra-checks"></span><code>--extra-checks</code></dt>
<dd>
<p>This flag enables additional checks that are technically correct but may be impractical in real code. In particular, it prohibits partial overlap in <code>TypedDict</code> updates, and makes arguments prepended via <code>Concatenate</code> positional-only. For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> TypedDict

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Foo</span>(TypedDict):
    a: <span style="color: #008000">int</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Bar</span>(TypedDict):
    a: <span style="color: #008000">int</span>
    b: <span style="color: #008000">int</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test</span>(foo: Foo, bar: Bar) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># This is technically unsafe since foo can have a subtype of Foo at</span>
    <span style="color: #3D7B7B; font-style: italic"># runtime, where type of key &quot;b&quot; is incompatible with int, see below</span>
    bar<span style="color: #666666">.</span>update(foo)

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Bad</span>(Foo):
    b: <span style="color: #008000">str</span>
bad: Bad <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;a&quot;</span>: <span style="color: #666666">0</span>, <span style="color: #BA2121">&quot;b&quot;</span>: <span style="color: #BA2121">&quot;no&quot;</span>}
test(bad, bar)
</code></pre></div>
</dd>
<dt><span id="strict"></span><code>--strict</code></dt>
<dd>
<p>This flag mode enables all optional error checking flags.  You can see the list of flags enabled by strict mode in the full <a href="#h">mypy --help</a> output.</p>
<p>Note: the exact list of flags enabled by running <a href="#strict">--strict</a> may change over time.</p>
</dd>
<dt><span id="disable-error-code"></span><code>--disable-error-code</code></dt>
<dd>
<p>This flag allows disabling one or multiple error codes globally. See <a href="../../mypy_other/error_codes/">Error codes</a> for more information.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># no flag</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()  <span style="color: #3D7B7B; font-style: italic"># error: &quot;str&quot; has no attribute &quot;trim&quot;  [attr-defined]</span>

<span style="color: #3D7B7B; font-style: italic"># When using --disable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()
</code></pre></div>
</dd>
<dt><span id="enable-error-code"></span><code>--enable-error-code</code></dt>
<dd>
<p>This flag allows enabling one or multiple error codes globally. See <a href="../../mypy_other/error_codes/">Error codes</a> for more information.</p>
<p>Note: This flag will override disabled error codes from the <a href="#disable-error-code">--disable-error-code</a> flag.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># When using --disable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()

<span style="color: #3D7B7B; font-style: italic"># --disable-error-code attr-defined --enable-error-code attr-defined</span>
x <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a string&#39;</span>
x<span style="color: #666666">.</span>trim()  <span style="color: #3D7B7B; font-style: italic"># error: &quot;str&quot; has no attribute &quot;trim&quot;  [attr-defined]</span>
</code></pre></div>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="配置错误消息">配置错误消息<a class="headerlink" href="#配置错误消息" title="Permanent link">&para;</a></h2>
<p><strong>Configuring error messages</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">中文</label><label for="__tabbed_12_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志允许您调整 mypy 在错误消息中显示的详细程度。</p>
<dl>
<dt><span id="show-error-context"></span><code>--show-error-context</code></dt>
<dd>
<p>该标志会在所有错误消息前面添加“note”信息，解释错误的上下文。例如，考虑以下程序：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Test</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">foo</span>(<span style="color: #008000">self</span>, x: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
        <span style="color: #008000; font-weight: bold">return</span> x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bar&quot;</span>
</code></pre></div>
<p>默认情况下，mypy 显示的错误消息如下：</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:3: error: Unsupported operand types for + (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
<p>如果启用此标志，错误消息将变为：</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py: note: In member &quot;foo&quot; of class &quot;Test&quot;:
main.py:3: error: Unsupported operand types for + (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
</dd>
<dt><span id="show-column-numbers"></span><code>--show-column-numbers</code></dt>
<dd>
<p>该标志会在错误消息中添加列偏移。例如，以下表示在第 12 行，第 9 列发生错误（注意列偏移从 0 开始）：</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:12:9: error: Unsupported operand types for / (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
</dd>
<dt><span id="show-error-code-links"></span><code>--show-error-code-links</code></dt>
<dd>
<p>该标志还会显示一个指向错误代码文档的链接，链接到由 mypy 报告的错误代码。相应的错误代码将在文档页面中高亮显示。如果启用此标志，错误消息将如下所示：</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:3: error: Unsupported operand types for - (&quot;int&quot; and &quot;str&quot;)  [operator]
main.py:3: note: See &#39;https://mypy.rtfd.io/en/stable/_refs.html#code-operator&#39; for more info
</code></pre></div>
</dd>
<dt><span id="show-error-end"></span><code>--show-error-end</code></dt>
<dd>
<p>该标志使 mypy 显示错误的起始位置和相关表达式的结束位置。这样，各种工具可以轻松高亮显示整个错误范围。格式为 <code>file:line:column:end_line:end_column</code>。此选项隐含启用 <code>--show-column-numbers</code>。</p>
</dd>
<dt><span id="hide-error-codes"></span><code>--hide-error-codes</code></dt>
<dd>
<p>该标志会在错误消息中隐藏错误代码 <code>[&lt;code&gt;]</code>。默认情况下，错误代码在每条错误消息之后显示：</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>prog.py:1: error: &quot;str&quot; has no attribute &quot;trim&quot;  [attr-defined]
</code></pre></div>
<p>有关更多信息，请参阅 <a href="../../mypy_other/error_codes/">错误代码</a>。</p>
</dd>
<dt><span id="pretty"></span><code>--pretty</code></dt>
<dd>
<p>在错误消息中使用视觉上更美观的输出：使用软换行，显示源代码片段，并显示错误位置标记。</p>
</dd>
<dt><span id="no-color-output"></span><code>--no-color-output</code></dt>
<dd>
<p>该标志会禁用错误消息中的彩色输出，默认启用。</p>
</dd>
<dt><span id="no-error-summary"></span><code>--no-error-summary</code></dt>
<dd>
<p>该标志会禁用错误总结。默认情况下，mypy 会显示一行总结，包括错误总数、包含错误的文件数和检查过的文件数。</p>
</dd>
<dt><span id="show-absolute-path"></span><code>--show-absolute-path</code></dt>
<dd>
<p>显示文件的绝对路径。</p>
</dd>
<dt><span id="soft-error-limit"></span><code>--soft-error-limit N</code></dt>
<dd>
<p>该标志会调整一个限制，超出该限制后，mypy 将（有时）禁用报告大多数额外错误。该限制仅在大多数剩余错误似乎不有用或过于嘈杂时适用。如果 <code>N</code> 为负数，则没有限制。默认限制为 -1。</p>
</dd>
<dt><span id="force-uppercase-builtins"></span><code>--force-uppercase-builtins</code></dt>
<dd>
<p>始终在错误消息中使用 <code>List</code> 而不是 <code>list</code>，即使在 Python 3.9+ 中也是如此。</p>
</dd>
<dt><span id="force-union-syntax"></span><code>--force-union-syntax</code></dt>
<dd>
<p>始终在错误消息中使用 <code>Union[]</code> 和 <code>Optional[]</code> 表示联合类型（而不是 <code>|</code> 运算符），即使在 Python 3.10+ 中也是如此。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags let you adjust how much detail mypy displays in error messages.</p>
<dl>
<dt><span id="show-error-context"></span><code>--show-error-context</code></dt>
<dd>
<p>This flag will precede all errors with "note" messages explaining the context of the error. For example, consider the following program:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Test</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">foo</span>(<span style="color: #008000">self</span>, x: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
        <span style="color: #008000; font-weight: bold">return</span> x <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;bar&quot;</span>
</code></pre></div>
<p>Mypy normally displays an error message that looks like this</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:3: error: Unsupported operand types for + (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
<p>If we enable this flag, the error message now looks like this</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py: note: In member &quot;foo&quot; of class &quot;Test&quot;:
main.py:3: error: Unsupported operand types for + (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
</dd>
<dt><span id="show-column-numbers"></span><code>--show-column-numbers</code></dt>
<dd>
<p>This flag will add column offsets to error messages. For example, the following indicates an error in line 12, column 9 (note that column offsets are 0-based)</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:12:9: error: Unsupported operand types for / (&quot;int&quot; and &quot;str&quot;)
</code></pre></div>
</dd>
<dt><span id="show-error-code-links"></span><code>--show-error-code-links</code></dt>
<dd>
<p>This flag will also display a link to error code documentation, anchored to the error code reported by mypy. The corresponding error code will be highlighted within the documentation page. If we enable this flag, the error message now looks like this</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>main.py:3: error: Unsupported operand types for - (&quot;int&quot; and &quot;str&quot;)  [operator]
main.py:3: note: See &#39;https://mypy.rtfd.io/en/stable/_refs.html#code-operator&#39; for more info
</code></pre></div>
</dd>
<dt><span id="show-error-end"></span><code>--show-error-end</code></dt>
<dd>
<p>This flag will make mypy show not just that start position where an error was detected, but also the end position of the relevant expression. This way various tools can easily highlight the whole error span. The format is <code>file:line:column:end_line:end_column</code>. This option implies <code>--show-column-numbers</code>.</p>
</dd>
<dt><span id="hide-error-codes"></span><code>--hide-error-codes</code></dt>
<dd>
<p>This flag will hide the error code <code>[&lt;code&gt;]</code> from error messages. By default, the error code is shown after each error message</p>
<div class="language-text highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>prog.py:1: error: &quot;str&quot; has no attribute &quot;trim&quot;  [attr-defined]
</code></pre></div>
<p>See <a href="../../mypy_other/error_codes/">Error codes</a> for more information.</p>
</dd>
<dt><span id="pretty"></span><code>--pretty</code></dt>
<dd>
<p>Use visually nicer output in error messages: use soft word wrap, show source code snippets, and show error location markers.</p>
</dd>
<dt><span id="no-color-output"></span><code>--no-color-output</code></dt>
<dd>
<p>This flag will disable color output in error messages, enabled by default.</p>
</dd>
<dt><span id="no-error-summary"></span><code>--no-error-summary</code></dt>
<dd>
<p>This flag will disable error summary. By default mypy shows a summary line including total number of errors, number of files with errors, and number of files checked.</p>
</dd>
<dt><span id="show-absolute-path"></span><code>--show-absolute-path</code></dt>
<dd>
<p>Show absolute paths to files.</p>
</dd>
<dt><span id="soft-error-limit"></span><code>--soft-error-limit N</code></dt>
<dd>
<p>This flag will adjust the limit after which mypy will (sometimes) disable reporting most additional errors. The limit only applies if it seems likely that most of the remaining errors will not be useful or they may be overly noisy. If <code>N</code> is negative, there is no limit. The default limit is -1.</p>
</dd>
<dt><span id="force-uppercase-builtins"></span><code>--force-uppercase-builtins</code></dt>
<dd>
<p>Always use <code>List</code> instead of <code>list</code> in error messages, even on Python 3.9+.</p>
</dd>
<dt><span id="force-union-syntax"></span><code>--force-union-syntax</code></dt>
<dd>
<p>Always use <code>Union[]</code> and <code>Optional[]</code> for union types in error messages (instead of the <code>|</code> operator), even on Python 3.10+.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="增量模式">增量模式<a class="headerlink" href="#增量模式" title="Permanent link">&para;</a></h2>
<p><strong>Incremental mode</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">中文</label><label for="__tabbed_13_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>默认情况下，mypy 会将类型信息存储到缓存中。mypy 会利用这些信息来避免在重新检查代码时进行不必要的重新计算。这可以帮助加快类型检查过程，特别是当大多数程序部分自上次 mypy 执行以来没有变化时。</p>
<p>如果您希望在增量模式所能提供的速度提升之外进一步加快代码重新检查的时间，可以尝试在 <a href="../mypy_daemon/">守护进程模式</a> 下运行 mypy。</p>
<dl>
<dt><span id="no-incremental"></span><code>--no-incremental</code></dt>
<dd>
<p>该标志禁用增量模式：mypy 在重新运行时将不再参考缓存。</p>
<p>请注意，即使增量模式被禁用，mypy 仍会将数据写入缓存：有关更多详细信息，请参见下面的 <a href="#cache-dir">--cache-dir</a> 标志。</p>
</dd>
<dt><span id="cache-dir"></span><code>--cache-dir DIR</code></dt>
<dd>
<p>默认情况下，mypy 将所有缓存数据存储在当前目录下名为 <code>.mypy_cache</code> 的文件夹中。此标志允许您更改此文件夹的位置。此标志还可用于在使用 <a href="../../mypy_other/additional_features/#使用远程缓存加速-mypy-运行">远程缓存</a> 时控制缓存的使用。</p>
<p>此设置会覆盖 <code>MYPY_CACHE_DIR</code> 环境变量（如果已设置）。</p>
<p>即使在禁用增量模式时，mypy 也会始终写入缓存，以便“预热”缓存。要禁用写入缓存，请使用 <code>--cache-dir=/dev/null</code>（UNIX）或 <code>--cache-dir=nul</code>（Windows）。</p>
</dd>
<dt><span id="sqlite-cache"></span><code>--sqlite-cache</code></dt>
<dd>
<p>使用 <a href="https://www.sqlite.org/">SQLite</a> 数据库存储缓存。</p>
</dd>
<dt><span id="cache-fine-grained"></span><code>--cache-fine-grained</code></dt>
<dd>
<p>在缓存中包含细粒度的依赖信息，用于 mypy 守护进程。</p>
</dd>
<dt><span id="skip-version-check"></span><code>--skip-version-check</code></dt>
<dd>
<p>默认情况下，mypy 会忽略由不同版本的 mypy 生成的缓存数据。此标志禁用此行为。</p>
</dd>
<dt><span id="skip-cache-mtime-checks"></span><code>--skip-cache-mtime-checks</code></dt>
<dd>
<p>跳过基于 mtime 的缓存内部一致性检查。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>By default, mypy will store type information into a cache. Mypy will use this information to avoid unnecessary recomputation when it type checks your code again.  This can help speed up the type checking process, especially when most parts of your program have not changed since the previous mypy run.</p>
<p>If you want to speed up how long it takes to recheck your code beyond what incremental mode can offer, try running mypy in <a href="../mypy_daemon/">daemon mode</a>.</p>
<dl>
<dt><span id="no-incremental"></span><code>--no-incremental</code></dt>
<dd>
<p>This flag disables incremental mode: mypy will no longer reference the cache when re-run.</p>
<p>Note that mypy will still write out to the cache even when incremental mode is disabled: see the <a href="#cache-dir">--cache-dir</a> flag below for more details.</p>
</dd>
<dt><span id="cache-dir"></span><code>--cache-dir DIR</code></dt>
<dd>
<p>By default, mypy stores all cache data inside of a folder named <code>.mypy_cache</code> in the current directory. This flag lets you change this folder. This flag can also be useful for controlling cache use when using <a href="../../mypy_other/additional_features/#使用远程缓存加速-mypy-运行">remote caching</a>.</p>
<p>This setting will override the <code>MYPY_CACHE_DIR</code> environment variable if it is set.</p>
<p>Mypy will also always write to the cache even when incremental mode is disabled so it can "warm up" the cache. To disable writing to the cache, use <code>--cache-dir=/dev/null</code> (UNIX) or <code>--cache-dir=nul</code> (Windows).</p>
</dd>
<dt><span id="sqlite-cache"></span><code>--sqlite-cache</code></dt>
<dd>
<p>Use an <a href="https://www.sqlite.org/">SQLite</a> database to store the cache.</p>
</dd>
<dt><span id="cache-fine-grained"></span><code>--cache-fine-grained</code></dt>
<dd>
<p>Include fine-grained dependency information in the cache for the mypy daemon.</p>
</dd>
<dt><span id="skip-version-check"></span><code>--skip-version-check</code></dt>
<dd>
<p>By default, mypy will ignore cache data generated by a different version of mypy. This flag disables that behavior.</p>
</dd>
<dt><span id="skip-cache-mtime-checks"></span><code>--skip-cache-mtime-checks</code></dt>
<dd>
<p>Skip cache internal consistency checks based on mtime.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="高级选项">高级选项<a class="headerlink" href="#高级选项" title="Permanent link">&para;</a></h2>
<p><strong>Advanced options</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">中文</label><label for="__tabbed_14_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>以下标志主要适用于对开发或调试 mypy 内部工作感兴趣的用户。</p>
<dl>
<dt><span id="pdb"></span><code>--pdb</code></dt>
<dd>
<p>这个标志会在 mypy 遇到致命错误时调用 Python 调试器（pdb）。</p>
</dd>
<dt><span id="show-traceback"></span><code>--show-traceback, --tb</code></dt>
<dd>
<p>如果设置了此标志，mypy 在遇到致命错误时会显示完整的回溯信息。</p>
</dd>
<dt><span id="raise-exceptions"></span><code>--raise-exceptions</code></dt>
<dd>
<p>在遇到致命错误时引发异常。</p>
</dd>
<dt><span id="custom-typing-module"></span><code>--custom-typing-module MODULE</code></dt>
<dd>
<p>这个标志允许您使用自定义模块来替代 <img alt="🇵🇾" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f1f5-1f1fe.svg" title=":py:" />mod:<code>typing</code> 模块。</p>
</dd>
<dt><span id="custom-typeshed-dir"></span><code>--custom-typeshed-dir DIR</code></dt>
<dd>
<p>这个标志指定 mypy 查找标准库类型的目录，而不是使用 mypy 自带的 typeshed。这主要用于在将 typeshed 更改提交到上游之前进行测试，但也允许您使用 typeshed 的分叉版本。</p>
<p>请注意，这不会影响第三方库的存根。要测试第三方存根，例如可以尝试 <code>MYPYPATH=stubs/six mypy ...</code>。</p>
</dd>
<dt><span id="warn-incomplete-stub"></span><code>--warn-incomplete-stub</code></dt>
<dd>
<p>这个标志会修改 <a href="#disallow-untyped-defs">--disallow-untyped-defs</a> 和 <a href="#disallow-incomplete-defs">--disallow-incomplete-defs</a> 标志，使它们在 typeshed 中的存根缺少类型注解或存在不完整的注解时也报告错误。如果两个标志都没有设置，<a href="#warn-incomplete-stub">--warn-incomplete-stub</a> 也不会起作用。</p>
<p>这个标志主要供那些希望为 typeshed 贡献代码的人使用，以便方便地发现类型注解的缺口和遗漏。</p>
<p>如果您希望 mypy 报告代码库中使用未注解的函数的错误（无论该函数是否在 typeshed 中定义），请使用 <a href="#disallow-untyped-calls">--disallow-untyped-calls</a> 标志。有关更多详细信息，请参见 <a href="#未类型化的定义与调用">未类型化的定义与调用</a>。</p>
</dd>
<dt><span id="shadow-file"></span><code>--shadow-file SOURCE_FILE SHADOW_FILE</code></dt>
<dd>
<p>当 mypy 被要求检查 <code>SOURCE_FILE</code> 时，这个标志会使 mypy 从 <code>SHADOW_FILE</code> 中读取并检查内容。然而，诊断信息仍会参考 <code>SOURCE_FILE</code>。</p>
<p>指定此参数多次（<code>--shadow-file X1 Y1 --shadow-file X2 Y2</code>）将允许 mypy 执行多个替换。</p>
<p>这使得工具可以创建具有有用修改的临时文件，而不需要直接更改源文件。例如，假设我们有一个管道，它为某些变量添加 <code>reveal_type</code>。这个管道在 <code>original.py</code> 上运行以生成 <code>temp.py</code>。运行 <code>mypy --shadow-file original.py temp.py original.py</code> 将使 mypy 检查 <code>temp.py</code> 的内容，而不是 <code>original.py</code>，但错误信息仍会引用 <code>original.py</code>。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>The following flags are useful mostly for people who are interested in developing or debugging mypy internals.</p>
<dl>
<dt><span id="pdb"></span><code>--pdb</code></dt>
<dd>
<p>This flag will invoke the Python debugger when mypy encounters a fatal error.</p>
</dd>
<dt><span id="show-traceback"></span><code>--show-traceback, --tb</code></dt>
<dd>
<p>If set, this flag will display a full traceback when mypy encounters a fatal error.</p>
</dd>
<dt><span id="raise-exceptions"></span><code>--raise-exceptions</code></dt>
<dd>
<p>Raise exception on fatal error.</p>
</dd>
<dt><span id="custom-typing-module"></span><code>--custom-typing-module MODULE</code></dt>
<dd>
<p>This flag lets you use a custom module as a substitute for the <img alt="🇵🇾" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f1f5-1f1fe.svg" title=":py:" />mod:<code>typing</code> module.</p>
</dd>
<dt><span id="custom-typeshed-dir"></span><code>--custom-typeshed-dir DIR</code></dt>
<dd>
<p>This flag specifies the directory where mypy looks for standard library typeshed stubs, instead of the typeshed that ships with mypy.  This is primarily intended to make it easier to test typeshed changes before submitting them upstream, but also allows you to use a forked version of typeshed.</p>
<p>Note that this doesn't affect third-party library stubs. To test third-party stubs, for example try <code>MYPYPATH=stubs/six mypy ...</code>.</p>
</dd>
<dt><span id="warn-incomplete-stub"></span><code>--warn-incomplete-stub</code></dt>
<dd>
<p>This flag modifies both the <a href="#disallow-untyped-defs">--disallow-untyped-defs</a> and <a href="#disallow-incomplete-defs">--disallow-incomplete-defs</a> flags so they also report errors if stubs in typeshed are missing type annotations or has incomplete annotations. If both flags are missing, <a href="#warn-incomplete-stub">--warn-incomplete-stub</a> also does nothing.</p>
<p>This flag is mainly intended to be used by people who want contribute to typeshed and would like a convenient way to find gaps and omissions.</p>
<p>If you want mypy to report an error when your codebase <em>uses</em> an untyped function, whether that function is defined in typeshed or not, use the <a href="#disallow-untyped-calls">--disallow-untyped-calls</a> flag. See <a href="#未类型化的定义与调用">Untyped definitions and calls</a> for more details.</p>
</dd>
<dt><span id="shadow-file"></span><code>--shadow-file SOURCE_FILE SHADOW_FILE</code></dt>
<dd>
<p>When mypy is asked to type check <code>SOURCE_FILE</code>, this flag makes mypy read from and type check the contents of <code>SHADOW_FILE</code> instead. However, diagnostics will continue to refer to <code>SOURCE_FILE</code>.</p>
<p>Specifying this argument multiple times (<code>--shadow-file X1 Y1 --shadow-file X2 Y2</code>) will allow mypy to perform multiple substitutions.</p>
<p>This allows tooling to create temporary files with helpful modifications without having to change the source file in place. For example, suppose we have a pipeline that adds <code>reveal_type</code> for certain variables. This pipeline is run on <code>original.py</code> to produce <code>temp.py</code>. Running <code>mypy --shadow-file original.py temp.py original.py</code> will then cause mypy to type check the contents of <code>temp.py</code> instead of  <code>original.py</code>, but error messages will still reference <code>original.py</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="报告生成">报告生成<a class="headerlink" href="#报告生成" title="Permanent link">&para;</a></h2>
<p><strong>Report generation</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">中文</label><label for="__tabbed_15_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>如果设置了这些标志，mypy 将会以指定的格式生成报告，并将其输出到指定的目录。</p>
<dl>
<dt><span id="any-exprs-report"></span><code>--any-exprs-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个文本文件报告，记录代码库中存在的 <code>Any</code> 类型表达式的数量。</p>
</dd>
<dt><span id="cobertura-xml-report"></span><code>--cobertura-xml-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个 Cobertura XML 类型检查覆盖率报告。</p>
<p>要生成此报告，您必须手动安装 [lxml] 库，或指定带有 setuptools 附加选项 <code>mypy[reports]</code> 的 mypy 安装。</p>
</dd>
<dt><span id="html-report"></span><code>--html-report / --xslt-html-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个 HTML 类型检查覆盖率报告。</p>
<p>要生成此报告，您必须手动安装 [lxml] 库，或指定带有 setuptools 附加选项 <code>mypy[reports]</code> 的 mypy 安装。</p>
</dd>
<dt><span id="linecount-report"></span><code>--linecount-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个文本文件报告，记录代码库中已类型化和未类型化的函数和行数。</p>
</dd>
<dt><span id="linecoverage"></span><code>--linecoverage-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个 JSON 文件，将每个源文件的绝对文件名映射到该文件中属于已类型化函数的行号列表。</p>
</dd>
<dt><span id="lineprecision"></span><code>--lineprecision-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个平面文本文件报告，包含每个模块的统计数据，如检查了多少行代码等。</p>
</dd>
<dt><span id="txt-report"></span><code>--txt-report / --xslt-txt-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个文本文件类型检查覆盖率报告。</p>
<p>要生成此报告，您必须手动安装 [lxml] 库，或指定带有 setuptools 附加选项 <code>mypy[reports]</code> 的 mypy 安装。</p>
</dd>
<dt><span id="xml-report"></span><code>--xml-report DIR</code></dt>
<dd>
<p>使 mypy 生成一个 XML 类型检查覆盖率报告。</p>
<p>要生成此报告，您必须手动安装 [lxml] 库，或指定带有 setuptools 附加选项 <code>mypy[reports]</code> 的 mypy 安装。</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<p>If these flags are set, mypy will generate a report in the specified format into the specified directory.</p>
<dl>
<dt><span id="any-exprs-report"></span><code>--any-exprs-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a text file report documenting how many expressions of type <code>Any</code> are present within your codebase.</p>
</dd>
<dt><span id="cobertura-xml-report"></span><code>--cobertura-xml-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a Cobertura XML type checking coverage report.</p>
<p>To generate this report, you must either manually install the [lxml] library or specify mypy installation with the setuptools extra <code>mypy[reports]</code>.</p>
</dd>
<dt><span id="html-report"></span><code>--html-report / --xslt-html-report DIR</code></dt>
<dd>
<p>Causes mypy to generate an HTML type checking coverage report.</p>
<p>To generate this report, you must either manually install the [lxml] library or specify mypy installation with the setuptools extra <code>mypy[reports]</code>.</p>
</dd>
<dt><span id="linecount-report"></span><code>--linecount-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a text file report documenting the functions and lines that are typed and untyped within your codebase.</p>
</dd>
<dt><span id="linecoverage"></span><code>--linecoverage-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a JSON file that maps each source file's absolute filename to a list of line numbers that belong to typed functions in that file.</p>
</dd>
<dt><span id="lineprecision"></span><code>--lineprecision-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a flat text file report with per-module statistics of how many lines are typechecked etc.</p>
</dd>
<dt><span id="txt-report"></span><code>--txt-report / --xslt-txt-report DIR</code></dt>
<dd>
<p>Causes mypy to generate a text file type checking coverage report.</p>
<p>To generate this report, you must either manually install the [lxml] library or specify mypy installation with the setuptools extra <code>mypy[reports]</code>.</p>
</dd>
<dt><span id="xml-report"></span><code>--xml-report DIR</code></dt>
<dd>
<p>Causes mypy to generate an XML type checking coverage report.</p>
<p>To generate this report, you must either manually install the [lxml] library or specify mypy installation with the setuptools extra <code>mypy[reports]</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<h2 id="启用不完整或实验性功能">启用不完整或实验性功能<a class="headerlink" href="#启用不完整或实验性功能" title="Permanent link">&para;</a></h2>
<p><strong>Enabling incomplete/experimental features</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">中文</label><label for="__tabbed_16_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<dl>
<dt><span id="enable-incomplete-feature"></span><code>--enable-incomplete-feature {PreciseTupleTypes, NewGenericSyntax, InlineTypedDict}</code></dt>
<dd>
<p>一些功能可能需要多个 mypy 版本来实现，例如由于其复杂性、潜在的向后不兼容性或可能从社区反馈中获益的模糊语义。您可以使用此标志启用这些功能以进行早期预览。请注意，并不保证所有功能最终都会默认启用。在 <em>极少数情况下</em>，我们可能决定不继续推进某些功能。</p>
</dd>
</dl>
<p>当前不完整/实验性功能列表：</p>
<ul>
<li>
<p><code>PreciseTupleTypes</code>: 此功能将在各种场景中推断更精确的元组类型。在 <a href="https://peps.python.org/pep-0646/">PEP 646</a> 添加变参类型之前，无法表达像“至少包含两个整数的元组”这样的类型。最好的类型是 <code>tuple[int, ...]</code>。因此，mypy 对变长元组进行了非常宽松的检查。现在，这种类型可以表示为 <code>tuple[int, int, *tuple[int, ...]]</code>。对于这样的更精确类型（当用户显式 <em>定义</em> 时），例如，mypy 会警告不安全的索引访问，并以类型安全的方式处理它们。然而，为了避免现有代码中的问题，mypy 并不会 <em>推断</em> 这些精确类型，即使技术上可以。以下是 <code>PreciseTupleTypes</code> 推断更精确类型的显著示例：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>numbers: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>]

more_numbers <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">*</span>numbers, <span style="color: #666666">1</span>)
reveal_type(more_numbers)
<span style="color: #3D7B7B; font-style: italic"># 没有 PreciseTupleTypes: tuple[int, ...]</span>
<span style="color: #3D7B7B; font-style: italic"># 有 PreciseTupleTypes: tuple[int, *tuple[int, ...], int]</span>

other_numbers <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">1</span>) <span style="color: #666666">+</span> numbers
reveal_type(other_numbers)
<span style="color: #3D7B7B; font-style: italic"># 没有 PreciseTupleTypes: tuple[int, ...]</span>
<span style="color: #3D7B7B; font-style: italic"># 有 PreciseTupleTypes: tuple[int, int, *tuple[int, ...]]</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(numbers) <span style="color: #666666">&gt;</span> <span style="color: #666666">2</span>:
    reveal_type(numbers)
    <span style="color: #3D7B7B; font-style: italic"># 没有 PreciseTupleTypes: tuple[int, ...]</span>
    <span style="color: #3D7B7B; font-style: italic"># 有 PreciseTupleTypes: tuple[int, int, int, *tuple[int, ...]]</span>
<span style="color: #008000; font-weight: bold">else</span>:
    reveal_type(numbers)
    <span style="color: #3D7B7B; font-style: italic"># 没有 PreciseTupleTypes: tuple[int, ...]</span>
    <span style="color: #3D7B7B; font-style: italic"># 有 PreciseTupleTypes: tuple[()] | tuple[int] | tuple[int, int]</span>
</code></pre></div>
</li>
<li>
<p><code>NewGenericSyntax</code>: 此功能启用对 <a href="https://peps.python.org/pep-0695/">PEP 695</a> 定义的语法的支持。例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Container</span>[T]:  <span style="color: #3D7B7B; font-style: italic"># 定义一个泛型类</span>
    content: T

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">first</span>[T](items: <span style="color: #008000">list</span>[T]) <span style="color: #666666">-&gt;</span> T:  <span style="color: #3D7B7B; font-style: italic"># 定义一个泛型函数</span>
    <span style="color: #008000; font-weight: bold">return</span> items[<span style="color: #666666">0</span>]

<span style="color: #008000">type</span> Items[T] <span style="color: #666666">=</span> <span style="color: #008000">list</span>[<span style="color: #008000">tuple</span>[T, T]]  <span style="color: #3D7B7B; font-style: italic"># 定义一个泛型类型别名</span>
</code></pre></div>
</li>
<li>
<p><code>InlineTypedDict</code>: 此功能启用用于内联 <a href="https://docs.python.org/3/library/typing.html#typing.TypedDict">TypedDicts</a> 的非标准语法，例如：</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_values</span>() <span style="color: #666666">-&gt;</span> {<span style="color: #BA2121">&quot;int&quot;</span>: <span style="color: #008000">int</span>, <span style="color: #BA2121">&quot;str&quot;</span>: <span style="color: #008000">str</span>}:
    <span style="color: #008000; font-weight: bold">return</span> {<span style="color: #BA2121">&quot;int&quot;</span>: <span style="color: #666666">42</span>, <span style="color: #BA2121">&quot;str&quot;</span>: <span style="color: #BA2121">&quot;test&quot;</span>}
</code></pre></div>
</li>
</ul>
</div>
<div class="tabbed-block">
<dl>
<dt><span id="enable-incomplete-feature"></span><code>--enable-incomplete-feature {PreciseTupleTypes, NewGenericSyntax, InlineTypedDict}</code></dt>
<dd>
<p>Some features may require several mypy releases to implement, for example due to their complexity, potential for backwards incompatibility, or ambiguous semantics that would benefit from feedback from the community. You can enable such features for early preview using this flag. Note that it is not guaranteed that all features will be ultimately enabled by default. In <em>rare cases</em> we may decide to not go ahead with certain features.</p>
</dd>
</dl>
<p>List of currently incomplete/experimental features:</p>
<ul>
<li>
<p><code>PreciseTupleTypes</code>: this feature will infer more precise tuple types in various scenarios. Before variadic types were added to the Python type system by <a href="https://peps.python.org/pep-0646/">PEP 646</a>, it was impossible to express a type like "a tuple with at least two integers". The best type available was <code>tuple[int, ...]</code>. Therefore, mypy applied very lenient checking for variable-length tuples. Now this type can be expressed as <code>tuple[int, int, *tuple[int, ...]]</code>. For such more precise types (when explicitly <em>defined</em> by a user) mypy, for example, warns about unsafe index access, and generally handles them in a type-safe manner. However, to avoid problems in existing code, mypy does not <em>infer</em> these precise types when it technically can. Here are notable examples where <code>PreciseTupleTypes</code> infers more precise types:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>numbers: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>]

more_numbers <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">*</span>numbers, <span style="color: #666666">1</span>)
reveal_type(more_numbers)
<span style="color: #3D7B7B; font-style: italic"># Without PreciseTupleTypes: tuple[int, ...]</span>
<span style="color: #3D7B7B; font-style: italic"># With PreciseTupleTypes: tuple[int, *tuple[int, ...], int]</span>

other_numbers <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">1</span>) <span style="color: #666666">+</span> numbers
reveal_type(other_numbers)
<span style="color: #3D7B7B; font-style: italic"># Without PreciseTupleTypes: tuple[int, ...]</span>
<span style="color: #3D7B7B; font-style: italic"># With PreciseTupleTypes: tuple[int, int, *tuple[int, ...]]</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(numbers) <span style="color: #666666">&gt;</span> <span style="color: #666666">2</span>:
    reveal_type(numbers)
    <span style="color: #3D7B7B; font-style: italic"># Without PreciseTupleTypes: tuple[int, ...]</span>
    <span style="color: #3D7B7B; font-style: italic"># With PreciseTupleTypes: tuple[int, int, int, *tuple[int, ...]]</span>
<span style="color: #008000; font-weight: bold">else</span>:
    reveal_type(numbers)
    <span style="color: #3D7B7B; font-style: italic"># Without PreciseTupleTypes: tuple[int, ...]</span>
    <span style="color: #3D7B7B; font-style: italic"># With PreciseTupleTypes: tuple[()] | tuple[int] | tuple[int, int]</span>
</code></pre></div>
</li>
<li>
<p><code>NewGenericSyntax</code>: this feature enables support for syntax defined by <a href="https://peps.python.org/pep-0695/">PEP 695</a>. For example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Container</span>[T]:  <span style="color: #3D7B7B; font-style: italic"># defines a generic class</span>
    content: T

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">first</span>[T](items: <span style="color: #008000">list</span>[T]) <span style="color: #666666">-&gt;</span> T:  <span style="color: #3D7B7B; font-style: italic"># defines a generic function</span>
    <span style="color: #008000; font-weight: bold">return</span> items[<span style="color: #666666">0</span>]

<span style="color: #008000">type</span> Items[T] <span style="color: #666666">=</span> <span style="color: #008000">list</span>[<span style="color: #008000">tuple</span>[T, T]]  <span style="color: #3D7B7B; font-style: italic"># defines a generic type alias</span>
</code></pre></div>
</li>
<li>
<p><code>InlineTypedDict</code>: this feature enables non-standard syntax for inline <a href="https://docs.python.org/3/library/typing.html#typing.TypedDict">TypedDicts</a>, for example:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_values</span>() <span style="color: #666666">-&gt;</span> {<span style="color: #BA2121">&quot;int&quot;</span>: <span style="color: #008000">int</span>, <span style="color: #BA2121">&quot;str&quot;</span>: <span style="color: #008000">str</span>}:
    <span style="color: #008000; font-weight: bold">return</span> {<span style="color: #BA2121">&quot;int&quot;</span>: <span style="color: #666666">42</span>, <span style="color: #BA2121">&quot;str&quot;</span>: <span style="color: #BA2121">&quot;test&quot;</span>}
</code></pre></div>
</li>
</ul>
</div>
</div>
</div>
<h2 id="其他">其他<a class="headerlink" href="#其他" title="Permanent link">&para;</a></h2>
<p><strong>Miscellaneous</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">中文</label><label for="__tabbed_17_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<dl>
<dt><span id="install-types"></span><code>--install-types</code></dt>
<dd>
<p>此标志使 mypy 使用 pip 安装已知缺失的第三方库的 stub 包。它将显示将要运行的 pip 命令，并在安装任何内容之前要求确认。出于安全原因，这些 stub 包仅限于一个小的手动选择的子集，这些包已由 typeshed 团队验证。这些包仅包含 stub 文件，不包含可执行代码。</p>
<p>如果使用此选项而未提供任何文件或模块进行类型检查，mypy 将安装在之前的 mypy 运行中建议的 stub 包。如果提供了文件或模块进行类型检查，mypy 会首先检查这些文件，然后在运行结束时建议安装缺失的 stub，但仅当检测到缺失的模块时才会这样做。</p>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>这是 mypy 0.900 中的新功能。之前的 mypy 版本包括了第三方包 stub 的选择，而不是单独安装它们。</p>
</div>
</dd>
<dt><span id="non-interactive"></span><code>--non-interactive</code></dt>
<dd>
<p>与 <a href="#install-types">--install-types</a> 一起使用时，此标志会使 mypy 使用 pip 自动安装所有建议的 stub 包，而无需确认，然后继续使用已安装的 stubs 进行类型检查（如果提供了文件或模块进行类型检查）。</p>
<p>这在内部实现为最多两次 mypy 运行。第一次运行用于查找缺失的 stub 包，仅在未找到缺失的 stub 包时才会显示此运行的输出。如果发现缺失的 stub 包，则会安装它们，然后执行另一次运行。</p>
</dd>
<dt><span id="junit-xml"></span><code>--junit-xml JUNIT_XML</code></dt>
<dd>
<p>此标志使 mypy 生成一个包含类型检查结果的 JUnit XML 测试结果文档。这可以更容易地将 mypy 集成到持续集成（CI）工具中。</p>
</dd>
<dt><span id="find-occurrences"></span><code>--find-occurrences CLASS.MEMBER</code></dt>
<dd>
<p>此标志将使 mypy 打印出基于静态类型信息的类成员的所有使用情况。此功能是实验性的。</p>
</dd>
<dt><span id="scripts-are-modules"></span><code>--scripts-are-modules</code></dt>
<dd>
<p>此标志将使命令行参数中看起来像脚本的文件（即名称不以 <code>.py</code> 结尾的文件）获得一个从脚本名称派生的模块名称，而不是固定的名称 <a href="https://docs.python.org/3/library/__main__.html#module-__main__">__main__</a>。</p>
<p>这使您可以在一次 mypy 调用中检查多个脚本。（默认的 <a href="https://docs.python.org/3/library/__main__.html#module-__main__">__main__</a> 从技术上讲更正确，但如果您有许多脚本导入大型包，则此标志启用的行为通常更方便。）</p>
</dd>
</dl>
</div>
<div class="tabbed-block">
<dl>
<dt><span id="install-types"></span><code>--install-types</code></dt>
<dd>
<p>This flag causes mypy to install known missing stub packages for third-party libraries using pip.  It will display the pip command that will be run, and expects a confirmation before installing anything. For security reasons, these stubs are limited to only a small subset of manually selected packages that have been verified by the typeshed team. These packages include only stub files and no executable code.</p>
<p>If you use this option without providing any files or modules to type check, mypy will install stub packages suggested during the previous mypy run. If there are files or modules to type check, mypy first type checks those, and proposes to install missing stubs at the end of the run, but only if any missing modules were detected.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is new in mypy 0.900. Previous mypy versions included a selection of third-party package stubs, instead of having them installed separately.</p>
</div>
</dd>
<dt><span id="non-interactive"></span><code>--non-interactive</code></dt>
<dd>
<p>hen used together with <a href="#install-types">--install-types</a>, this causes mypy to install all suggested stub packages using pip without asking for confirmation, and then continues to perform type checking using the installed stubs, if some files or modules are provided to type check.</p>
</dd>
</dl>
<p>This is implemented as up to two mypy runs internally. The first run is used to find missing stub packages, and output is shown from this run only if no missing stub packages were found. If missing stub packages were found, they are installed and then another run is performed.</p>
<dl>
<dt><span id="junit-xml"></span><code>--junit-xml JUNIT_XML</code></dt>
<dd>
<p>Causes mypy to generate a JUnit XML test result document with type checking results. This can make it easier to integrate mypy with continuous integration (CI) tools.</p>
</dd>
<dt><span id="find-occurrences"></span><code>--find-occurrences CLASS.MEMBER</code></dt>
<dd>
<p>This flag will make mypy print out all usages of a class member based on static type information. This feature is experimental.</p>
</dd>
<dt><span id="scripts-are-modules"></span><code>--scripts-are-modules</code></dt>
<dd>
<p>This flag will give command line arguments that appear to be scripts (i.e. files whose name does not end in <code>.py</code>) a module name derived from the script name rather than the fixed name <a href="https://docs.python.org/3/library/__main__.html#module-__main__">__main__</a>.</p>
<p>This lets you check more than one script in a single mypy invocation. (The default <a href="https://docs.python.org/3/library/__main__.html#module-__main__">__main__</a> is technically more correct, but if you have many scripts that import a large package, the behavior enabled by this flag is often more convenient.)</p>
</dd>
</dl>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月16日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月13日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>