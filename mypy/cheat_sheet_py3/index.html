
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="hellowac-类型检查">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../existing_code/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>类型提示备忘录 - mypy静态类型检查器</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#类型提示备忘录" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="mypy静态类型检查器" class="md-header__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mypy静态类型检查器
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              类型提示备忘录
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  欢迎来到mypy文档!

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  第一步

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../builtin_types/" class="md-tabs__link">
          
  
    
  
  类型系统参考

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy_conf/" class="md-tabs__link">
          
  
    
  
  配置和运行mypy

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../mypy_other/" class="md-tabs__link">
          
  
    
  
  其他杂项

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../mypy_other/project_links/" class="md-tabs__link">
        
  
    
  
  项目链接

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mypy静态类型检查器" class="md-nav__button md-logo" aria-label="mypy静态类型检查器" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    mypy静态类型检查器
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/mypy-zh-cn" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    hellowac/myppy-zh-cn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欢迎来到mypy文档!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    第一步
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            第一步
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    类型提示备忘录
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    类型提示备忘录
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#变量" class="md-nav__link">
    变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#有用的内置类型" class="md-nav__link">
    有用的内置类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#函数" class="md-nav__link">
    函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#类" class="md-nav__link">
    类
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#当你感到困惑或事情变得复杂时" class="md-nav__link">
    当你感到困惑或事情变得复杂时
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#标准鸭子类型" class="md-nav__link">
    标准“鸭子类型”
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#前置引用forward-reference" class="md-nav__link">
    前置引用（forward reference）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#装饰器" class="md-nav__link">
    装饰器
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#协程和-asyncio" class="md-nav__link">
    协程和 asyncio
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../existing_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将 mypy 与现有代码库结合使用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    类型系统参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            类型系统参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../builtin_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内置类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../type_inference_type_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型推断和类型注解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../kind_of_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型种类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../class_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类的基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../annotation_issue_at_runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行时的注解问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../protocol_and_struct_subtyping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    协议及其子类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_typing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    动态类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../type_narrowing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型收缩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../duck_type_compatibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    鸭子类型兼容
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../stub_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    存根文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../generics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泛型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../more_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    更多类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../literal_and_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    字面量和枚举
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../typeddict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    类型字典
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../final_names_methods_classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最终名称、方法和类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../metaclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    元类
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy_conf/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    配置和运行mypy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            配置和运行mypy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/running_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行mypy和管理导入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/command_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy命令行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/config_file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy配置文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/inline_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内联配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/mypy_daemon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mypy服务(守护进程)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/installed_packages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    使用安装包
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/extending_mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    扩展和集成 mypy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/stubgen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_conf/stubtest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动存根测试
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mypy_other/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    其他杂项
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            其他杂项
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/common_issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题及解决办法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/supported_python_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    支持的 Python 特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_code_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    默认启用的错误码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/error_code_list2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    可选检查的错误代码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/additional_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    额外特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见问题解答
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../mypy_other/project_links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    项目链接
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#变量" class="md-nav__link">
    变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#有用的内置类型" class="md-nav__link">
    有用的内置类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#函数" class="md-nav__link">
    函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#类" class="md-nav__link">
    类
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#当你感到困惑或事情变得复杂时" class="md-nav__link">
    当你感到困惑或事情变得复杂时
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#标准鸭子类型" class="md-nav__link">
    标准“鸭子类型”
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#前置引用forward-reference" class="md-nav__link">
    前置引用（forward reference）
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#装饰器" class="md-nav__link">
    装饰器
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#协程和-asyncio" class="md-nav__link">
    协程和 asyncio
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="类型提示备忘录">类型提示备忘录<a class="headerlink" href="#类型提示备忘录" title="Permanent link">&para;</a></h1>
<p><strong>Type hints cheat sheet</strong></p>
<p>转自: <a href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html">https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html</a></p>
<h2 id="变量">变量<a class="headerlink" href="#变量" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>从技术上讲，下面显示的许多类型注解都是多余的，因为 mypy 通常可以从变量的值推断出变量的类型。 有关更多详细信息，请参阅<a href="https://mypy.readthedocs.io/en/stable/type_inference_and_annotations.html#type-inference-and-annotations">类型推断和类型注解</a>。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 这是声明变量类型的方式</span>
age: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">1</span>

<span style="color: #3D7B7B; font-style: italic"># 您不需要初始化变量来注解它</span>
a: <span style="color: #008000">int</span>  <span style="color: #3D7B7B; font-style: italic"># Ok (在分配之前在运行时没有值)</span>

<span style="color: #3D7B7B; font-style: italic"># 这样做在条件分支中很有用</span>
child: <span style="color: #008000">bool</span>
<span style="color: #008000; font-weight: bold">if</span> age <span style="color: #666666">&lt;</span> <span style="color: #666666">18</span>:
    child <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #008000; font-weight: bold">else</span>:
    child <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Variables</strong></p>
<p>Technically many of the type annotations shown below are redundant, since mypy can usually infer the type of a variable from its value. See Type inference and type annotations for more details.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># This is how you declare the type of a variable</span>
age: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">1</span>

<span style="color: #3D7B7B; font-style: italic"># You don&#39;t need to initialize a variable to annotate it</span>
a: <span style="color: #008000">int</span>  <span style="color: #3D7B7B; font-style: italic"># Ok (no value at runtime until assigned)</span>

<span style="color: #3D7B7B; font-style: italic"># Doing so can be useful in conditional branches</span>
child: <span style="color: #008000">bool</span>
<span style="color: #008000; font-weight: bold">if</span> age <span style="color: #666666">&lt;</span> <span style="color: #666666">18</span>:
    child <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #008000; font-weight: bold">else</span>:
    child <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="有用的内置类型">有用的内置类型<a class="headerlink" href="#有用的内置类型" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 对于大多数类型，只需在注解中使用类型的名称, 请注意，mypy 通常可以从变量的值推断变量的类型，因此从技术上讲，这些注解是多余的</span>
x: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">1</span>
x: <span style="color: #008000">float</span> <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
x: <span style="color: #008000">bool</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
x: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;test&quot;</span>
x: <span style="color: #008000">bytes</span> <span style="color: #666666">=</span> <span style="color: #BA2121">b&quot;test&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># 对于 Python 3.9+ 上的集合，集合项的类型位于括号中</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> [<span style="color: #666666">1</span>]
x: <span style="color: #008000">set</span>[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> {<span style="color: #666666">6</span>, <span style="color: #666666">7</span>}

<span style="color: #3D7B7B; font-style: italic"># 对于映射，我们需要键和值的类型</span>
x: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;field&quot;</span>: <span style="color: #666666">2.0</span>}  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># 对于固定大小的元组，我们指定所有元素的类型</span>
x: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> (<span style="color: #666666">3</span>, <span style="color: #BA2121">&quot;yes&quot;</span>, <span style="color: #666666">7.5</span>)  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># 对于可变大小的元组，我们使用一种类型和省略号</span>
x: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>] <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># 在 Python 3.8 及更早版本中，集合类型的名称大写，并且类型是从“typing”模块导入的</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> List, Set, Dict, Tuple
x: List[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> [<span style="color: #666666">1</span>]
x: Set[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> {<span style="color: #666666">6</span>, <span style="color: #666666">7</span>}
x: Dict[<span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;field&quot;</span>: <span style="color: #666666">2.0</span>}
x: Tuple[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> (<span style="color: #666666">3</span>, <span style="color: #BA2121">&quot;yes&quot;</span>, <span style="color: #666666">7.5</span>)
x: Tuple[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>] <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Union, Optional

<span style="color: #3D7B7B; font-style: italic"># 在 Python 3.10+ 上，使用 | 当某值可能是几种类型之一时的运算符</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">int</span> <span style="color: #666666">|</span> <span style="color: #008000">str</span>] <span style="color: #666666">=</span> [<span style="color: #666666">3</span>, <span style="color: #666666">5</span>, <span style="color: #BA2121">&quot;test&quot;</span>, <span style="color: #BA2121">&quot;fun&quot;</span>]  <span style="color: #3D7B7B; font-style: italic"># Python 3.10+</span>
<span style="color: #3D7B7B; font-style: italic"># 在早期版本中，使用 Union</span>
x: <span style="color: #008000">list</span>[Union[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]] <span style="color: #666666">=</span> [<span style="color: #666666">3</span>, <span style="color: #666666">5</span>, <span style="color: #BA2121">&quot;test&quot;</span>, <span style="color: #BA2121">&quot;fun&quot;</span>]

<span style="color: #3D7B7B; font-style: italic"># 使用 Optional[X] 作为可能为None的值</span>
<span style="color: #3D7B7B; font-style: italic"># Optional[X] 与 X | None 相同 或 Union[X，None]</span>
x: Optional[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;something&quot;</span> <span style="color: #008000; font-weight: bold">if</span> some_condition() <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">None</span>
<span style="color: #008000; font-weight: bold">if</span> x <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># 由于 if 语句，Mypy 知道 x 不会在这里为 None</span>
    <span style="color: #008000">print</span>(x<span style="color: #666666">.</span>upper())
<span style="color: #3D7B7B; font-style: italic"># 如果您知道由于 mypy 不理解的某些逻辑，某个值永远不可能为 None，请使用断言</span>
<span style="color: #008000; font-weight: bold">assert</span> x <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
<span style="color: #008000">print</span>(x<span style="color: #666666">.</span>upper())
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Useful built-in types</strong></p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># For most types, just use the name of the type in the annotation</span>
<span style="color: #3D7B7B; font-style: italic"># Note that mypy can usually infer the type of a variable from its value,</span>
<span style="color: #3D7B7B; font-style: italic"># so technically these annotations are redundant</span>
x: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">1</span>
x: <span style="color: #008000">float</span> <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
x: <span style="color: #008000">bool</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
x: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;test&quot;</span>
x: <span style="color: #008000">bytes</span> <span style="color: #666666">=</span> <span style="color: #BA2121">b&quot;test&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># For collections on Python 3.9+, the type of the collection item is in brackets</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> [<span style="color: #666666">1</span>]
x: <span style="color: #008000">set</span>[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> {<span style="color: #666666">6</span>, <span style="color: #666666">7</span>}

<span style="color: #3D7B7B; font-style: italic"># For mappings, we need the types of both keys and values</span>
x: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;field&quot;</span>: <span style="color: #666666">2.0</span>}  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># For tuples of fixed size, we specify the types of all the elements</span>
x: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> (<span style="color: #666666">3</span>, <span style="color: #BA2121">&quot;yes&quot;</span>, <span style="color: #666666">7.5</span>)  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># For tuples of variable size, we use one type and ellipsis</span>
x: <span style="color: #008000">tuple</span>[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>] <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)  <span style="color: #3D7B7B; font-style: italic"># Python 3.9+</span>

<span style="color: #3D7B7B; font-style: italic"># On Python 3.8 and earlier, the name of the collection type is</span>
<span style="color: #3D7B7B; font-style: italic"># capitalized, and the type is imported from the &#39;typing&#39; module</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> List, Set, Dict, Tuple
x: List[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> [<span style="color: #666666">1</span>]
x: Set[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> {<span style="color: #666666">6</span>, <span style="color: #666666">7</span>}
x: Dict[<span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;field&quot;</span>: <span style="color: #666666">2.0</span>}
x: Tuple[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>, <span style="color: #008000">float</span>] <span style="color: #666666">=</span> (<span style="color: #666666">3</span>, <span style="color: #BA2121">&quot;yes&quot;</span>, <span style="color: #666666">7.5</span>)
x: Tuple[<span style="color: #008000">int</span>, <span style="color: #666666">...</span>] <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Union, Optional

<span style="color: #3D7B7B; font-style: italic"># On Python 3.10+, use the | operator when something could be one of a few types</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">int</span> <span style="color: #666666">|</span> <span style="color: #008000">str</span>] <span style="color: #666666">=</span> [<span style="color: #666666">3</span>, <span style="color: #666666">5</span>, <span style="color: #BA2121">&quot;test&quot;</span>, <span style="color: #BA2121">&quot;fun&quot;</span>]  <span style="color: #3D7B7B; font-style: italic"># Python 3.10+</span>
<span style="color: #3D7B7B; font-style: italic"># On earlier versions, use Union</span>
x: <span style="color: #008000">list</span>[Union[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]] <span style="color: #666666">=</span> [<span style="color: #666666">3</span>, <span style="color: #666666">5</span>, <span style="color: #BA2121">&quot;test&quot;</span>, <span style="color: #BA2121">&quot;fun&quot;</span>]

<span style="color: #3D7B7B; font-style: italic"># Use Optional[X] for a value that could be None</span>
<span style="color: #3D7B7B; font-style: italic"># Optional[X] is the same as X | None or Union[X, None]</span>
x: Optional[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;something&quot;</span> <span style="color: #008000; font-weight: bold">if</span> some_condition() <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000; font-weight: bold">None</span>
<span style="color: #008000; font-weight: bold">if</span> x <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #3D7B7B; font-style: italic"># Mypy understands x won&#39;t be None here because of the if-statement</span>
    <span style="color: #008000">print</span>(x<span style="color: #666666">.</span>upper())
<span style="color: #3D7B7B; font-style: italic"># If you know a value can never be None due to some logic that mypy doesn&#39;t</span>
<span style="color: #3D7B7B; font-style: italic"># understand, use an assert</span>
<span style="color: #008000; font-weight: bold">assert</span> x <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
<span style="color: #008000">print</span>(x<span style="color: #666666">.</span>upper())
</code></pre></div>
</div>
</div>
</div>
<h2 id="函数">函数<a class="headerlink" href="#函数" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Callable, Iterator, Union, Optional

<span style="color: #3D7B7B; font-style: italic"># 这是注解函数定义的方式</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">stringify</span>(num: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">str</span>(num)

<span style="color: #3D7B7B; font-style: italic"># 以下是指定多个参数的方法</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plus</span>(num1: <span style="color: #008000">int</span>, num2: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
    <span style="color: #008000; font-weight: bold">return</span> num1 <span style="color: #666666">+</span> num2

<span style="color: #3D7B7B; font-style: italic"># 如果函数没有返回值，则使用 None 作为返回类型</span>
<span style="color: #3D7B7B; font-style: italic"># 参数的默认值位于类型注解之后</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">show</span>(value: <span style="color: #008000">str</span>, excitement: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">10</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000">print</span>(value <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;!&quot;</span> <span style="color: #666666">*</span> excitement)

<span style="color: #3D7B7B; font-style: italic"># 请注意，没有类型的参数是动态类型的（视为 Any）</span>
<span style="color: #3D7B7B; font-style: italic"># 并且该函数没有任何未检查的注解</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">untyped</span>(x):
    x<span style="color: #666666">.</span>anything() <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;string&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># no errors</span>

<span style="color: #3D7B7B; font-style: italic"># 这是注解可调用（函数）值的方式</span>
x: Callable[[<span style="color: #008000">int</span>, <span style="color: #008000">float</span>], <span style="color: #008000">float</span>] <span style="color: #666666">=</span> f
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">register</span>(callback: Callable[[<span style="color: #008000">str</span>], <span style="color: #008000">int</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>: <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># 生成整数的生成器函数实际上只是一个函数</span>
<span style="color: #3D7B7B; font-style: italic"># 返回一个整数迭代器，这就是我们注解它的方式</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">gen</span>(n: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> Iterator[<span style="color: #008000">int</span>]:
    i <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span> i <span style="color: #666666">&lt;</span> n:
        <span style="color: #008000; font-weight: bold">yield</span> i
        i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>

<span style="color: #3D7B7B; font-style: italic"># 您当然可以将函数注解拆分为多行</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">send_email</span>(address: Union[<span style="color: #008000">str</span>, <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               sender: <span style="color: #008000">str</span>,
               cc: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               bcc: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               subject: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>,
               body: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
               ) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># Mypy 能够理解仅位置参数和仅关键字参数</span>
<span style="color: #3D7B7B; font-style: italic"># 也可以使用以两个下划线开头的名称来标记仅位置参数</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">quux</span>(x: <span style="color: #008000">int</span>, <span style="color: #666666">/</span>, <span style="color: #666666">*</span>, y: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000; font-weight: bold">pass</span>

quux(<span style="color: #666666">3</span>, y<span style="color: #666666">=5</span>)  <span style="color: #3D7B7B; font-style: italic"># Ok</span>
quux(<span style="color: #666666">3</span>, <span style="color: #666666">5</span>)  <span style="color: #3D7B7B; font-style: italic"># error: “quux”的位置参数太多</span>
quux(x<span style="color: #666666">=3</span>, y<span style="color: #666666">=5</span>)  <span style="color: #3D7B7B; font-style: italic"># error: “quux”的意外关键字参数“x”</span>

<span style="color: #3D7B7B; font-style: italic"># 这表示每个位置参数和每个关键字参数都是一个“str”</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">call</span>(<span style="color: #008000">self</span>, <span style="color: #666666">*</span>args: <span style="color: #008000">str</span>, <span style="color: #666666">**</span>kwargs: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    reveal_type(args)  <span style="color: #3D7B7B; font-style: italic"># 揭示的类型是 &quot;tuple[str, ...]&quot;</span>
    reveal_type(kwargs)  <span style="color: #3D7B7B; font-style: italic"># 揭示的类型是 &quot;dict[str, str]&quot;</span>
    request <span style="color: #666666">=</span> make_request(<span style="color: #666666">*</span>args, <span style="color: #666666">**</span>kwargs)
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>do_api_query(request)
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Functions</strong></p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Callable, Iterator, Union, Optional

<span style="color: #3D7B7B; font-style: italic"># This is how you annotate a function definition</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">stringify</span>(num: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">str</span>(num)

<span style="color: #3D7B7B; font-style: italic"># And here&#39;s how you specify multiple arguments</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plus</span>(num1: <span style="color: #008000">int</span>, num2: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:
    <span style="color: #008000; font-weight: bold">return</span> num1 <span style="color: #666666">+</span> num2

<span style="color: #3D7B7B; font-style: italic"># If a function does not return a value, use None as the return type</span>
<span style="color: #3D7B7B; font-style: italic"># Default value for an argument goes after the type annotation</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">show</span>(value: <span style="color: #008000">str</span>, excitement: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">10</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000">print</span>(value <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;!&quot;</span> <span style="color: #666666">*</span> excitement)

<span style="color: #3D7B7B; font-style: italic"># Note that arguments without a type are dynamically typed (treated as Any)</span>
<span style="color: #3D7B7B; font-style: italic"># and that functions without any annotations not checked</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">untyped</span>(x):
    x<span style="color: #666666">.</span>anything() <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;string&quot;</span>  <span style="color: #3D7B7B; font-style: italic"># no errors</span>

<span style="color: #3D7B7B; font-style: italic"># This is how you annotate a callable (function) value</span>
x: Callable[[<span style="color: #008000">int</span>, <span style="color: #008000">float</span>], <span style="color: #008000">float</span>] <span style="color: #666666">=</span> f
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">register</span>(callback: Callable[[<span style="color: #008000">str</span>], <span style="color: #008000">int</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>: <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># A generator function that yields ints is secretly just a function that</span>
<span style="color: #3D7B7B; font-style: italic"># returns an iterator of ints, so that&#39;s how we annotate it</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">gen</span>(n: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> Iterator[<span style="color: #008000">int</span>]:
    i <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span> i <span style="color: #666666">&lt;</span> n:
        <span style="color: #008000; font-weight: bold">yield</span> i
        i <span style="color: #666666">+=</span> <span style="color: #666666">1</span>

<span style="color: #3D7B7B; font-style: italic"># You can of course split a function annotation over multiple lines</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">send_email</span>(address: Union[<span style="color: #008000">str</span>, <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               sender: <span style="color: #008000">str</span>,
               cc: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               bcc: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]],
               subject: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>,
               body: Optional[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
               ) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># Mypy understands positional-only and keyword-only arguments</span>
<span style="color: #3D7B7B; font-style: italic"># Positional-only arguments can also be marked by using a name starting with</span>
<span style="color: #3D7B7B; font-style: italic"># two underscores</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">quux</span>(x: <span style="color: #008000">int</span>, <span style="color: #666666">/</span>, <span style="color: #666666">*</span>, y: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    <span style="color: #008000; font-weight: bold">pass</span>

quux(<span style="color: #666666">3</span>, y<span style="color: #666666">=5</span>)  <span style="color: #3D7B7B; font-style: italic"># Ok</span>
quux(<span style="color: #666666">3</span>, <span style="color: #666666">5</span>)  <span style="color: #3D7B7B; font-style: italic"># error: Too many positional arguments for &quot;quux&quot;</span>
quux(x<span style="color: #666666">=3</span>, y<span style="color: #666666">=5</span>)  <span style="color: #3D7B7B; font-style: italic"># error: Unexpected keyword argument &quot;x&quot; for &quot;quux&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># This says each positional arg and each keyword arg is a &quot;str&quot;</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">call</span>(<span style="color: #008000">self</span>, <span style="color: #666666">*</span>args: <span style="color: #008000">str</span>, <span style="color: #666666">**</span>kwargs: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    reveal_type(args)  <span style="color: #3D7B7B; font-style: italic"># Revealed type is &quot;tuple[str, ...]&quot;</span>
    reveal_type(kwargs)  <span style="color: #3D7B7B; font-style: italic"># Revealed type is &quot;dict[str, str]&quot;</span>
    request <span style="color: #666666">=</span> make_request(<span style="color: #666666">*</span>args, <span style="color: #666666">**</span>kwargs)
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>do_api_query(request)
</code></pre></div>
</div>
</div>
</div>
<h2 id="类">类<a class="headerlink" href="#类" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">BankAccount</span>:
    <span style="color: #3D7B7B; font-style: italic"># “__init__”方法不返回任何内容，因此它的返回类型为“None”，就像任何其他不返回任何内容的方法一样</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, account_name: <span style="color: #008000">str</span>, initial_balance: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #3D7B7B; font-style: italic"># mypy 将根据参数的类型推断这些实例变量的正确类型。</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>account_name <span style="color: #666666">=</span> account_name
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">=</span> initial_balance

    <span style="color: #3D7B7B; font-style: italic"># 对于实例方法，省略“self”的类型</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">-=</span> amount

<span style="color: #3D7B7B; font-style: italic"># 用户定义的类作为注解中的类型有效</span>
account: BankAccount <span style="color: #666666">=</span> BankAccount(<span style="color: #BA2121">&quot;Alice&quot;</span>, <span style="color: #666666">400</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">transfer</span>(src: BankAccount, dst: BankAccount, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src<span style="color: #666666">.</span>withdraw(amount)
    dst<span style="color: #666666">.</span>deposit(amount)

<span style="color: #3D7B7B; font-style: italic"># 接受 BankAccount 的函数也接受 BankAccount 的任何子类！</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AuditedBankAccount</span>(BankAccount):
    <span style="color: #3D7B7B; font-style: italic"># 您可以选择在类主体中声明实例变量</span>
    audit_log: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]
    <span style="color: #3D7B7B; font-style: italic"># 这是一个具有默认值的实例变量</span>
    auditor_name: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;The Spanish Inquisition&quot;</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, account_name: <span style="color: #008000">str</span>, initial_balance: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">super</span>()<span style="color: #666666">.</span><span style="color: #0000FF">__init__</span>(account_name, initial_balance)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;Deposited </span><span style="color: #A45A77; font-weight: bold">{</span>amount<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;Withdrew </span><span style="color: #A45A77; font-weight: bold">{</span>amount<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">-=</span> amount

audited <span style="color: #666666">=</span> AuditedBankAccount(<span style="color: #BA2121">&quot;Bob&quot;</span>, <span style="color: #666666">300</span>)
transfer(audited, account, <span style="color: #666666">100</span>)  <span style="color: #3D7B7B; font-style: italic"># 类型检查!</span>

<span style="color: #3D7B7B; font-style: italic"># 可以使用ClassVar注解来声明类变量</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Car</span>:
    seats: ClassVar[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #666666">4</span>
    passengers: ClassVar[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]]

<span style="color: #3D7B7B; font-style: italic"># 如果您想要类上的动态属性，请让它覆盖“__setattr__”或“__getattr__”</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #3D7B7B; font-style: italic"># 如果 x 与“value”的类型相同，则这将允许分配给任何 A.x</span>
    <span style="color: #3D7B7B; font-style: italic"># （使用“value: Any”允许任意类型）</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__setattr__</span>(<span style="color: #008000">self</span>, name: <span style="color: #008000">str</span>, value: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>: <span style="color: #666666">...</span>

    <span style="color: #3D7B7B; font-style: italic"># 如果 x 与返回类型兼容，这将允许访问任何 A.x</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__getattr__</span>(<span style="color: #008000">self</span>, name: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>: <span style="color: #666666">...</span>

a<span style="color: #666666">.</span>foo <span style="color: #666666">=</span> <span style="color: #666666">42</span>  <span style="color: #3D7B7B; font-style: italic"># OK</span>
a<span style="color: #666666">.</span>bar <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;Ex-parrot&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># 类型检查失败</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Classes</strong></p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">BankAccount</span>:
    <span style="color: #3D7B7B; font-style: italic"># The &quot;__init__&quot; method doesn&#39;t return anything, so it gets return</span>
    <span style="color: #3D7B7B; font-style: italic"># type &quot;None&quot; just like any other method that doesn&#39;t return anything</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, account_name: <span style="color: #008000">str</span>, initial_balance: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #3D7B7B; font-style: italic"># mypy will infer the correct types for these instance variables</span>
        <span style="color: #3D7B7B; font-style: italic"># based on the types of the parameters.</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>account_name <span style="color: #666666">=</span> account_name
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">=</span> initial_balance

    <span style="color: #3D7B7B; font-style: italic"># For instance methods, omit type for &quot;self&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">-=</span> amount

<span style="color: #3D7B7B; font-style: italic"># User-defined classes are valid as types in annotations</span>
account: BankAccount <span style="color: #666666">=</span> BankAccount(<span style="color: #BA2121">&quot;Alice&quot;</span>, <span style="color: #666666">400</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">transfer</span>(src: BankAccount, dst: BankAccount, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    src<span style="color: #666666">.</span>withdraw(amount)
    dst<span style="color: #666666">.</span>deposit(amount)

<span style="color: #3D7B7B; font-style: italic"># Functions that accept BankAccount also accept any subclass of BankAccount!</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AuditedBankAccount</span>(BankAccount):
    <span style="color: #3D7B7B; font-style: italic"># You can optionally declare instance variables in the class body</span>
    audit_log: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]
    <span style="color: #3D7B7B; font-style: italic"># This is an instance variable with a default value</span>
    auditor_name: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;The Spanish Inquisition&quot;</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, account_name: <span style="color: #008000">str</span>, initial_balance: <span style="color: #008000">int</span> <span style="color: #666666">=</span> <span style="color: #666666">0</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">super</span>()<span style="color: #666666">.</span><span style="color: #0000FF">__init__</span>(account_name, initial_balance)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;Deposited </span><span style="color: #A45A77; font-weight: bold">{</span>amount<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>audit_log<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;Withdrew </span><span style="color: #A45A77; font-weight: bold">{</span>amount<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">-=</span> amount

audited <span style="color: #666666">=</span> AuditedBankAccount(<span style="color: #BA2121">&quot;Bob&quot;</span>, <span style="color: #666666">300</span>)
transfer(audited, account, <span style="color: #666666">100</span>)  <span style="color: #3D7B7B; font-style: italic"># type checks!</span>

<span style="color: #3D7B7B; font-style: italic"># You can use the ClassVar annotation to declare a class variable</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Car</span>:
    seats: ClassVar[<span style="color: #008000">int</span>] <span style="color: #666666">=</span> <span style="color: #666666">4</span>
    passengers: ClassVar[<span style="color: #008000">list</span>[<span style="color: #008000">str</span>]]

<span style="color: #3D7B7B; font-style: italic"># If you want dynamic attributes on your class, have it</span>
<span style="color: #3D7B7B; font-style: italic"># override &quot;__setattr__&quot; or &quot;__getattr__&quot;</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #3D7B7B; font-style: italic"># This will allow assignment to any A.x, if x is the same type as &quot;value&quot;</span>
    <span style="color: #3D7B7B; font-style: italic"># (use &quot;value: Any&quot; to allow arbitrary types)</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__setattr__</span>(<span style="color: #008000">self</span>, name: <span style="color: #008000">str</span>, value: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>: <span style="color: #666666">...</span>

    <span style="color: #3D7B7B; font-style: italic"># This will allow access to any A.x, if x is compatible with the return type</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__getattr__</span>(<span style="color: #008000">self</span>, name: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>: <span style="color: #666666">...</span>

a<span style="color: #666666">.</span>foo <span style="color: #666666">=</span> <span style="color: #666666">42</span>  <span style="color: #3D7B7B; font-style: italic"># Works</span>
a<span style="color: #666666">.</span>bar <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;Ex-parrot&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># Fails type checking</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="当你感到困惑或事情变得复杂时">当你感到困惑或事情变得复杂时<a class="headerlink" href="#当你感到困惑或事情变得复杂时" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Union, Any, Optional, TYPE_CHECKING, cast

<span style="color: #3D7B7B; font-style: italic"># 要找出 mypy 为程序中任何位置的表达式推断出什么类型，请将其包装在 Reveal_type() 中。 Mypy 将打印一条带有类型的错误消息； 在运行代码之前再次删除它。</span>
reveal_type(<span style="color: #666666">1</span>)  <span style="color: #3D7B7B; font-style: italic"># 揭示的类型是 &quot;builtins.int&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># 如果您使用空容器或“None”初始化变量，您可能需要通过提供显式类型注解来帮助 mypy</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
x: Optional[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

<span style="color: #3D7B7B; font-style: italic"># 如果您不知道某事物的类型或者它太动态而无法为其编写类型，请使用 Any</span>
x: Any <span style="color: #666666">=</span> mystery_function()
<span style="color: #3D7B7B; font-style: italic"># Mypy 会让你用 x 做任何事情！</span>
x<span style="color: #666666">.</span>whatever() <span style="color: #666666">*</span> x[<span style="color: #BA2121">&quot;you&quot;</span>] <span style="color: #666666">+</span> x(<span style="color: #BA2121">&quot;want&quot;</span>) <span style="color: #666666">-</span> <span style="color: #008000">any</span>(x) <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #008000">all</span>(x) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">super</span>  <span style="color: #3D7B7B; font-style: italic"># no errors</span>

<span style="color: #3D7B7B; font-style: italic"># 当您的代码混淆 mypy 或在 mypy 中遇到彻底的错误时，使用“type:ignore”注解来抑制给定行上的错误。</span>
<span style="color: #3D7B7B; font-style: italic"># 好的做法是添加解释问题的评论。</span>
x <span style="color: #666666">=</span> confusing_function()  <span style="color: #3D7B7B; font-style: italic"># type: ignore  # 混乱的函数不会在这里返回 None 因为......</span>

<span style="color: #3D7B7B; font-style: italic"># “cast”是一个辅助函数，可让您覆盖表达式的推断类型。 它仅适用于 mypy——没有运行时检查。</span>
a <span style="color: #666666">=</span> [<span style="color: #666666">4</span>]
b <span style="color: #666666">=</span> cast(<span style="color: #008000">list</span>[<span style="color: #008000">int</span>], a)  <span style="color: #3D7B7B; font-style: italic"># 通过良好</span>
c <span style="color: #666666">=</span> cast(<span style="color: #008000">list</span>[<span style="color: #008000">str</span>], a)  <span style="color: #3D7B7B; font-style: italic"># 尽管是谎言，但仍通过良好（没有运行时检查）</span>
reveal_type(c)  <span style="color: #3D7B7B; font-style: italic"># 揭示的类型是 &quot;builtins.list[builtins.str]&quot;</span>
<span style="color: #008000">print</span>(c)  <span style="color: #3D7B7B; font-style: italic"># 仍然打印 [4] ...该对象在运行时未更改或转换</span>

<span style="color: #3D7B7B; font-style: italic"># 如果您想要 mypy 可以看到但不会在运行时执行的代码（或者想要 mypy 看不到的代码），请使用“TYPE_CHECKING”</span>
<span style="color: #008000; font-weight: bold">if</span> TYPE_CHECKING:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">json</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">orjson</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">json</span>  <span style="color: #3D7B7B; font-style: italic"># mypy 不知道这一点</span>
</code></pre></div>
<p>在某些情况下，类型注解可能会在运行时导致问题，请参阅<a href="https://mypy.readthedocs.io/en/stable/runtime_troubles.html#runtime-troubles">运行时注解问题</a>来处理此问题。</p>
<p>有关如何消除错误的详细信息，请参阅<a href="https://mypy.readthedocs.io/en/stable/type_inference_and_annotations.html#silencing-type-errors">消除类型错误</a>。</p>
</div>
<div class="tabbed-block">
<p><strong>When you’re puzzled or when things are complicated</strong></p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Union, Any, Optional, TYPE_CHECKING, cast

<span style="color: #3D7B7B; font-style: italic"># To find out what type mypy infers for an expression anywhere in</span>
<span style="color: #3D7B7B; font-style: italic"># your program, wrap it in reveal_type().  Mypy will print an error</span>
<span style="color: #3D7B7B; font-style: italic"># message with the type; remove it again before running the code.</span>
reveal_type(<span style="color: #666666">1</span>)  <span style="color: #3D7B7B; font-style: italic"># Revealed type is &quot;builtins.int&quot;</span>

<span style="color: #3D7B7B; font-style: italic"># If you initialize a variable with an empty container or &quot;None&quot;</span>
<span style="color: #3D7B7B; font-style: italic"># you may have to help mypy a bit by providing an explicit type annotation</span>
x: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
x: Optional[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

<span style="color: #3D7B7B; font-style: italic"># Use Any if you don&#39;t know the type of something or it&#39;s too</span>
<span style="color: #3D7B7B; font-style: italic"># dynamic to write a type for</span>
x: Any <span style="color: #666666">=</span> mystery_function()
<span style="color: #3D7B7B; font-style: italic"># Mypy will let you do anything with x!</span>
x<span style="color: #666666">.</span>whatever() <span style="color: #666666">*</span> x[<span style="color: #BA2121">&quot;you&quot;</span>] <span style="color: #666666">+</span> x(<span style="color: #BA2121">&quot;want&quot;</span>) <span style="color: #666666">-</span> <span style="color: #008000">any</span>(x) <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #008000">all</span>(x) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">super</span>  <span style="color: #3D7B7B; font-style: italic"># no errors</span>

<span style="color: #3D7B7B; font-style: italic"># Use a &quot;type: ignore&quot; comment to suppress errors on a given line,</span>
<span style="color: #3D7B7B; font-style: italic"># when your code confuses mypy or runs into an outright bug in mypy.</span>
<span style="color: #3D7B7B; font-style: italic"># Good practice is to add a comment explaining the issue.</span>
x <span style="color: #666666">=</span> confusing_function()  <span style="color: #3D7B7B; font-style: italic"># type: ignore  # confusing_function won&#39;t return None here because ...</span>

<span style="color: #3D7B7B; font-style: italic"># &quot;cast&quot; is a helper function that lets you override the inferred</span>
<span style="color: #3D7B7B; font-style: italic"># type of an expression. It&#39;s only for mypy -- there&#39;s no runtime check.</span>
a <span style="color: #666666">=</span> [<span style="color: #666666">4</span>]
b <span style="color: #666666">=</span> cast(<span style="color: #008000">list</span>[<span style="color: #008000">int</span>], a)  <span style="color: #3D7B7B; font-style: italic"># Passes fine</span>
c <span style="color: #666666">=</span> cast(<span style="color: #008000">list</span>[<span style="color: #008000">str</span>], a)  <span style="color: #3D7B7B; font-style: italic"># Passes fine despite being a lie (no runtime check)</span>
reveal_type(c)  <span style="color: #3D7B7B; font-style: italic"># Revealed type is &quot;builtins.list[builtins.str]&quot;</span>
<span style="color: #008000">print</span>(c)  <span style="color: #3D7B7B; font-style: italic"># Still prints [4] ... the object is not changed or casted at runtime</span>

<span style="color: #3D7B7B; font-style: italic"># Use &quot;TYPE_CHECKING&quot; if you want to have code that mypy can see but will not</span>
<span style="color: #3D7B7B; font-style: italic"># be executed at runtime (or to have code that mypy can&#39;t see)</span>
<span style="color: #008000; font-weight: bold">if</span> TYPE_CHECKING:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">json</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">orjson</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">json</span>  <span style="color: #3D7B7B; font-style: italic"># mypy is unaware of this</span>
</code></pre></div>
<p>In some cases type annotations can cause issues at runtime, see <a href="https://mypy.readthedocs.io/en/stable/runtime_troubles.html#runtime-troubles">Annotation issues at runtime</a> for dealing with this.</p>
<p>See <a href="https://mypy.readthedocs.io/en/stable/type_inference_and_annotations.html#silencing-type-errors">Silencing type errors</a> for details on how to silence errors.</p>
</div>
</div>
</div>
<h2 id="标准鸭子类型">标准“鸭子类型”<a class="headerlink" href="#标准鸭子类型" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在典型的 Python 代码中，许多可以将列表或字典作为参数的函数只需要它们的参数在某种程度上“类似于列表”或“类似于字典”。 “类似列表”或“类似字典”（或类似其他东西）的特定含义称为“鸭子类型”，并且在惯用的Python中常见的几种鸭子类型已标准化。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Mapping, MutableMapping, Sequence, Iterable

<span style="color: #3D7B7B; font-style: italic"># 将 Iterable 用于通用可迭代对象（“for”中可用的任何内容），并在需要序列（支持“len”和“__getitem__”）时使用 Sequence</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(ints: Iterable[<span style="color: #008000">int</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]:
    <span style="color: #008000; font-weight: bold">return</span> [<span style="color: #008000">str</span>(x) <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> ints]

f(<span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #666666">3</span>))

<span style="color: #3D7B7B; font-style: italic"># Mapping 描述了一个我们不会改变的类似 dict 的对象（带有“__getitem__”），而 MutableMapping 则描述了一个我们可能会改变的对象（带有“__setitem__”）</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(my_mapping: Mapping[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">list</span>[<span style="color: #008000">int</span>]:
    my_mapping[<span style="color: #666666">5</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;maybe&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># mypy 会抱怨这行......</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">list</span>(my_mapping<span style="color: #666666">.</span>keys())

f({<span style="color: #666666">3</span>: <span style="color: #BA2121">&#39;yes&#39;</span>, <span style="color: #666666">4</span>: <span style="color: #BA2121">&#39;no&#39;</span>})

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(my_mapping: MutableMapping[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">set</span>[<span style="color: #008000">str</span>]:
    my_mapping[<span style="color: #666666">5</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;maybe&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># ...但 mypy 对此表示同意。</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">set</span>(my_mapping<span style="color: #666666">.</span>values())

f({<span style="color: #666666">3</span>: <span style="color: #BA2121">&#39;yes&#39;</span>, <span style="color: #666666">4</span>: <span style="color: #BA2121">&#39;no&#39;</span>})

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> IO

<span style="color: #3D7B7B; font-style: italic"># 对于应该接受或返回来自 open() 调用的对象的函数，请使用 IO[str] 或 IO[bytes]（请注意，IO 不区分读、写或其他模式）</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_sys_IO</span>(mode: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;w&#39;</span>) <span style="color: #666666">-&gt;</span> IO[<span style="color: #008000">str</span>]:
    <span style="color: #008000; font-weight: bold">if</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;w&#39;</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdout
    <span style="color: #008000; font-weight: bold">elif</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;r&#39;</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdin
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdout
</code></pre></div>
<p>您甚至可以使用<a href="https://mypy.readthedocs.io/en/stable/protocols.html#protocol-types">协议和结构子类型</a>创建自己的鸭子类型。</p>
</div>
<div class="tabbed-block">
<p><strong>Standard “duck types”</strong></p>
<p>In typical Python code, many functions that can take a list or a dict as an argument only need their argument to be somehow “list-like” or “dict-like”. A specific meaning of “list-like” or “dict-like” (or something-else-like) is called a “duck type”, and several duck types that are common in idiomatic Python are standardized.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Mapping, MutableMapping, Sequence, Iterable

<span style="color: #3D7B7B; font-style: italic"># Use Iterable for generic iterables (anything usable in &quot;for&quot;),</span>
<span style="color: #3D7B7B; font-style: italic"># and Sequence where a sequence (supporting &quot;len&quot; and &quot;__getitem__&quot;) is</span>
<span style="color: #3D7B7B; font-style: italic"># required</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(ints: Iterable[<span style="color: #008000">int</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">list</span>[<span style="color: #008000">str</span>]:
    <span style="color: #008000; font-weight: bold">return</span> [<span style="color: #008000">str</span>(x) <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> ints]

f(<span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #666666">3</span>))

<span style="color: #3D7B7B; font-style: italic"># Mapping describes a dict-like object (with &quot;__getitem__&quot;) that we won&#39;t</span>
<span style="color: #3D7B7B; font-style: italic"># mutate, and MutableMapping one (with &quot;__setitem__&quot;) that we might</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(my_mapping: Mapping[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">list</span>[<span style="color: #008000">int</span>]:
    my_mapping[<span style="color: #666666">5</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;maybe&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># mypy will complain about this line...</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">list</span>(my_mapping<span style="color: #666666">.</span>keys())

f({<span style="color: #666666">3</span>: <span style="color: #BA2121">&#39;yes&#39;</span>, <span style="color: #666666">4</span>: <span style="color: #BA2121">&#39;no&#39;</span>})

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(my_mapping: MutableMapping[<span style="color: #008000">int</span>, <span style="color: #008000">str</span>]) <span style="color: #666666">-&gt;</span> <span style="color: #008000">set</span>[<span style="color: #008000">str</span>]:
    my_mapping[<span style="color: #666666">5</span>] <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;maybe&#39;</span>  <span style="color: #3D7B7B; font-style: italic"># ...but mypy is OK with this.</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">set</span>(my_mapping<span style="color: #666666">.</span>values())

f({<span style="color: #666666">3</span>: <span style="color: #BA2121">&#39;yes&#39;</span>, <span style="color: #666666">4</span>: <span style="color: #BA2121">&#39;no&#39;</span>})

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> IO

<span style="color: #3D7B7B; font-style: italic"># Use IO[str] or IO[bytes] for functions that should accept or return</span>
<span style="color: #3D7B7B; font-style: italic"># objects that come from an open() call (note that IO does not</span>
<span style="color: #3D7B7B; font-style: italic"># distinguish between reading, writing or other modes)</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_sys_IO</span>(mode: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;w&#39;</span>) <span style="color: #666666">-&gt;</span> IO[<span style="color: #008000">str</span>]:
    <span style="color: #008000; font-weight: bold">if</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;w&#39;</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdout
    <span style="color: #008000; font-weight: bold">elif</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;r&#39;</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdin
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> sys<span style="color: #666666">.</span>stdout
</code></pre></div>
<p>You can even make your own duck types using <a href="https://mypy.readthedocs.io/en/stable/protocols.html#protocol-types">Protocols and structural subtyping</a>.</p>
</div>
</div>
</div>
<h2 id="前置引用forward-reference">前置引用（forward reference）<a class="headerlink" href="#前置引用forward-reference" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># 您可能想在定义类之前引用它。这称为“前置类型（forward reference）”。</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: A) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># 这将在运行时失败，因为“A”未定义</span>
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># 但是，如果添加以下特殊导入：</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">__future__</span> <span style="color: #008000; font-weight: bold">import</span> annotations
<span style="color: #3D7B7B; font-style: italic"># 它将在运行时工作，并且只要文件中稍后存在该名称的类，类型检查就会成功</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: A) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># Ok</span>
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># 另一种选择是将类型放在引号中</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: <span style="color: #BA2121">&#39;A&#39;</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># Also ok</span>
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #3D7B7B; font-style: italic"># 如果您需要在该类定义内的类型注解中引用该类，也会出现这种情况</span>
    <span style="color: #AA22FF">@classmethod</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">create</span>(<span style="color: #008000">cls</span>) <span style="color: #666666">-&gt;</span> A:
        <span style="color: #666666">...</span>
</code></pre></div>
<p>有关更多详细信息，请参阅<a href="https://mypy.readthedocs.io/en/stable/runtime_troubles.html#forward-references">类名前置引用</a>。</p>
</div>
<div class="tabbed-block">
<p><strong>Forward references</strong></p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic"># You may want to reference a class before it is defined.</span>
<span style="color: #3D7B7B; font-style: italic"># This is known as a &quot;forward reference&quot;.</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: A) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># This will fail at runtime with &#39;A&#39; is not defined</span>
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># However, if you add the following special import:</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">__future__</span> <span style="color: #008000; font-weight: bold">import</span> annotations
<span style="color: #3D7B7B; font-style: italic"># It will work at runtime and type checking will succeed as long as there</span>
<span style="color: #3D7B7B; font-style: italic"># is a class of that name later on in the file</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: A) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># Ok</span>
    <span style="color: #666666">...</span>

<span style="color: #3D7B7B; font-style: italic"># Another option is to just put the type in quotes</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(foo: <span style="color: #BA2121">&#39;A&#39;</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">int</span>:  <span style="color: #3D7B7B; font-style: italic"># Also ok</span>
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #3D7B7B; font-style: italic"># This can also come up if you need to reference a class in a type</span>
    <span style="color: #3D7B7B; font-style: italic"># annotation inside the definition of that class</span>
    <span style="color: #AA22FF">@classmethod</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">create</span>(<span style="color: #008000">cls</span>) <span style="color: #666666">-&gt;</span> A:
        <span style="color: #666666">...</span>
</code></pre></div>
<p>See <a href="https://mypy.readthedocs.io/en/stable/runtime_troubles.html#forward-references">Class name forward references</a> for more details.</p>
</div>
</div>
</div>
<h2 id="装饰器">装饰器<a class="headerlink" href="#装饰器" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">中文</label><label for="__tabbed_8_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>装饰器函数可以通过泛型来表达。 有关更多详细信息，请参阅<a href="https://mypy.readthedocs.io/en/stable/generics.html#declaring-decorators">声明装饰器</a>。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Any, Callable, TypeVar

F <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;F&#39;</span>, bound<span style="color: #666666">=</span>Callable[<span style="color: #666666">...</span>, Any])

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bare_decorator</span>(func: F) <span style="color: #666666">-&gt;</span> F:
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">decorator_args</span>(url: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> Callable[[F], F]:
    <span style="color: #666666">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Decorators</strong></p>
<p>Decorator functions can be expressed via generics. See <a href="https://mypy.readthedocs.io/en/stable/generics.html#declaring-decorators">Declaring decorators</a> for more details.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">typing</span> <span style="color: #008000; font-weight: bold">import</span> Any, Callable, TypeVar

F <span style="color: #666666">=</span> TypeVar(<span style="color: #BA2121">&#39;F&#39;</span>, bound<span style="color: #666666">=</span>Callable[<span style="color: #666666">...</span>, Any])

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bare_decorator</span>(func: F) <span style="color: #666666">-&gt;</span> F:
    <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">decorator_args</span>(url: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> Callable[[F], F]:
    <span style="color: #666666">...</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="协程和-asyncio">协程和 asyncio<a class="headerlink" href="#协程和-asyncio" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">中文</label><label for="__tabbed_9_2">原文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>有关编写协程和异步代码的完整详细信息，请参阅<a href="https://mypy.readthedocs.io/en/stable/more_types.html#async-and-await">注解 async/await</a>。</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">asyncio</span>

<span style="color: #3D7B7B; font-style: italic"># 协程的类型与普通函数类似</span>

<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">countdown</span>(tag: <span style="color: #008000">str</span>, count: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    <span style="color: #008000; font-weight: bold">while</span> count <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;T-minus </span><span style="color: #A45A77; font-weight: bold">{</span>count<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> (</span><span style="color: #A45A77; font-weight: bold">{</span>tag<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">)&#39;</span>)
        <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
        count <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;Blastoff!&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Coroutines and asyncio</strong></p>
<p>See <a href="https://mypy.readthedocs.io/en/stable/more_types.html#async-and-await">Typing async/await</a> for the full detail on typing coroutines and asynchronous code.</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">asyncio</span>

<span style="color: #3D7B7B; font-style: italic"># A coroutine is typed like a normal function</span>

<span style="color: #008000; font-weight: bold">async</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">countdown</span>(tag: <span style="color: #008000">str</span>, count: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
    <span style="color: #008000; font-weight: bold">while</span> count <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;T-minus </span><span style="color: #A45A77; font-weight: bold">{</span>count<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> (</span><span style="color: #A45A77; font-weight: bold">{</span>tag<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">)&#39;</span>)
        <span style="color: #008000; font-weight: bold">await</span> asyncio<span style="color: #666666">.</span>sleep(<span style="color: #666666">0.1</span>)
        count <span style="color: #666666">-=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;Blastoff!&quot;</span>
</code></pre></div>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月4日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月4日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>